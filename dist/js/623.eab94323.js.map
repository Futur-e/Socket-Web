{"version":3,"file":"js/623.eab94323.js","mappings":"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","sources":["webpack://socket_chat_vue3/./src/hooks/subscribe.ts","webpack://socket_chat_vue3/./src/hooks/webrtc.ts","webpack://socket_chat_vue3/./src/views/Chat.vue?ce3f","webpack://socket_chat_vue3/./src/components/chatWindow/ChatWindow.vue?7a5e","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/ChatDialog.vue?8d05","webpack://socket_chat_vue3/./src/api/chat.ts","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/children/userItem.vue?c378","webpack://socket_chat_vue3/./src/components/DownloadCard.vue?7149","webpack://socket_chat_vue3/./src/components/DownloadCard.vue?5c5b","webpack://socket_chat_vue3/./src/components/DownloadCard.vue","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/children/userItem.vue?7c63","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/children/userItem.vue","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/children/talkerItem.vue?b772","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/children/talkerItem.vue?b750","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/children/talkerItem.vue","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/children/NotificationTag.vue?ed1f","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/children/NotificationTag.vue?18f0","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/children/NotificationTag.vue","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/ChatDialog.vue?c243","webpack://socket_chat_vue3/./src/components/chatWindow/children/chatDialog/ChatDialog.vue","webpack://socket_chat_vue3/./src/components/chatWindow/children/ChatTopBar.vue?943a","webpack://socket_chat_vue3/./src/components/chatWindow/children/ChatTopBar.vue?3239","webpack://socket_chat_vue3/./src/components/chatWindow/children/ChatTopBar.vue","webpack://socket_chat_vue3/./src/components/chatWindow/children/InputBox.vue?717d","webpack://socket_chat_vue3/./src/components/ChatInput.vue?ae04","webpack://socket_chat_vue3/./src/components/ChatInput.vue?aead","webpack://socket_chat_vue3/./src/components/ChatInput.vue","webpack://socket_chat_vue3/./src/components/EmojiDialog.vue?0417","webpack://socket_chat_vue3/./src/api/emoticon.ts","webpack://socket_chat_vue3/./src/components/EmojiDialog.vue?38fe","webpack://socket_chat_vue3/./src/components/EmojiDialog.vue","webpack://socket_chat_vue3/./src/components/UploadCmp.vue?355b","webpack://socket_chat_vue3/./src/components/UploadCmp.vue?299b","webpack://socket_chat_vue3/./src/components/UploadCmp.vue","webpack://socket_chat_vue3/./src/components/chatWindow/children/InputBox.vue?e109","webpack://socket_chat_vue3/./src/components/chatWindow/children/InputBox.vue","webpack://socket_chat_vue3/./src/components/chatWindow/children/NotiDialog.vue?f050","webpack://socket_chat_vue3/./src/api/notification.ts","webpack://socket_chat_vue3/./src/components/chatWindow/children/NotiDialog.vue?a358","webpack://socket_chat_vue3/./src/components/chatWindow/children/NotiDialog.vue","webpack://socket_chat_vue3/./src/components/chatWindow/children/VideoWindow.vue?d495","webpack://socket_chat_vue3/./src/components/chatWindow/children/VideoWindow.vue?15f3","webpack://socket_chat_vue3/./src/components/chatWindow/children/VideoWindow.vue","webpack://socket_chat_vue3/./src/components/chatWindow/ChatWindow.vue?0506","webpack://socket_chat_vue3/./src/components/chatWindow/ChatWindow.vue","webpack://socket_chat_vue3/./src/components/SessionList.vue?bc67","webpack://socket_chat_vue3/./src/components/SessionList.vue?de8d","webpack://socket_chat_vue3/./src/components/SessionList.vue","webpack://socket_chat_vue3/./src/views/Chat.vue?6761","webpack://socket_chat_vue3/./src/views/Chat.vue"],"sourcesContent":["import { Subscribe } from \"@/type\";\r\nimport { onBeforeUnmount } from \"vue\";\r\n\r\nexport default function (subList: Subscribe[]) {\r\n  subList.forEach((item, index, list) => {\r\n    list[index]['token'] = PubSub.subscribe(item.msgName, item.callback)\r\n  })\r\n\r\n  onBeforeUnmount(() => {\r\n    subList.forEach(item => {\r\n      PubSub.unsubscribe(item.token as string)\r\n    })\r\n  })\r\n}","import store from \"@/store\";\r\nimport { PC } from \"@/type\";\r\nimport { message } from \"ant-design-vue\";\r\nimport { nextTick } from \"vue\";\r\n\r\nconst pcOption = {\r\n  iceServers: [\r\n    { urls: 'stun:stun.xten.com' },\r\n    { urls: 'stun:stun.voipbuster.com' },\r\n  ]\r\n}\r\n\r\ninterface WebRtcType {\r\n  // mode: sender / receiver\r\n  mode: string,\r\n  // type: videoCall / privateChat \r\n  type: string[],\r\n}\r\n\r\nexport default function ({ mode, type }: WebRtcType) {\r\n  let remoteVideo: HTMLMediaElement\r\n  let localVideo: HTMLMediaElement\r\n  let mediaStream: MediaStream\r\n  let remoteStream: MediaStream\r\n  let dc: RTCDataChannel\r\n\r\n  const onicecandidate = (e: RTCPeerConnectionIceEvent) => {\r\n    if (e.candidate) {\r\n      window.$socket.emit('webRTC', {\r\n        type: 'candidate',\r\n        data: e.candidate,\r\n        receiverId: store.state.currentSession?.receiverId,\r\n      })\r\n    } else {\r\n      console.log('候选人收集完成!');\r\n    }\r\n  }\r\n\r\n  const ontrack = (e: RTCTrackEvent) => {\r\n    nextTick(() => {\r\n      remoteVideo = document.querySelector('#remote-video') as HTMLMediaElement;\r\n      if (remoteVideo.srcObject !== e.streams[0]) {\r\n        remoteVideo.srcObject = e.streams[0];\r\n        remoteStream = e.streams[0]\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  const oniceconnectionstatechange = () => {\r\n    // checking connected disconnected\r\n    if (pc.iceConnectionState === 'disconnected') {\r\n      hangup()\r\n      message.info('对方已挂断通话!')\r\n    }\r\n  }\r\n\r\n  const getLocalMediaStream = async () => {\r\n    mediaStream = await navigator.mediaDevices.getUserMedia({ audio: false, video: true })\r\n\r\n    nextTick(() => {\r\n      localVideo = document.querySelector('#local-video') as HTMLMediaElement;\r\n      localVideo.srcObject = mediaStream;\r\n    })\r\n\r\n    // 绑定本地媒体数据到pc对象上\r\n    mediaStream.getTracks().forEach(track => {\r\n      pc.addTrack(track, mediaStream);\r\n    });\r\n  };\r\n\r\n  const hangup = () => {\r\n    if (pc.iceConnectionState === 'new') {\r\n      // 发送取消请求通知\r\n      window.$socket.emit('webRTC', {\r\n        type: 'videoReq',\r\n        data: 'cancel',\r\n        senderId: store.state.userInfo?.id,\r\n        receiverId: store.state.currentSession?.receiverId,\r\n      })\r\n    }\r\n\r\n    mediaStream?.getTracks().forEach(track => track.stop())\r\n    remoteStream?.getTracks().forEach(track => track.stop())\r\n    type = type.filter(item => item !== 'videoCall')\r\n    // 判断是否还存在其它类型\r\n    if (!type.length) pc.close()\r\n\r\n    store.commit('setChatStatus', { type: 'videoCall', status: false })\r\n    store.commit('setPC', null)\r\n  }\r\n\r\n  const createAnswer = async () => {\r\n    // 绑定远端sdp\r\n    const answer = await pc.createAnswer()\r\n    // 绑定本地sdp\r\n    await pc.setLocalDescription(answer)\r\n    // 发送本地sdp到远端\r\n    window.$socket.emit('webRTC', {\r\n      type: 'answer',\r\n      data: answer,\r\n      senderId: store.state.userInfo?.id,\r\n      receiverId: store.state.currentSession?.receiverId,\r\n    })\r\n  }\r\n\r\n  const createOffer = async () => {\r\n    // 获取本地sdp(offer)\r\n    const offer = await pc.createOffer()\r\n    // 绑定本地sdp\r\n    await pc.setLocalDescription(offer)\r\n    // 发送本地sdp到远端\r\n    window.$socket.emit('webRTC', {\r\n      type: 'offer',\r\n      data: offer,\r\n      senderId: store.state.userInfo?.id,\r\n      receiverId: store.state.currentSession?.receiverId,\r\n    })\r\n  }\r\n\r\n  const createDataChannelFunc = () => {\r\n    dc = pc.createDataChannel(\"privateChat\")\r\n    dc.onopen = (e) => {\r\n      console.log('createDataChannel', e);\r\n      dc.send('hi there!')\r\n    }\r\n\r\n    dc.onmessage = (e) => {\r\n      console.log(e.data);\r\n    }\r\n  }\r\n\r\n  const ondatachannel = (e: RTCDataChannelEvent) => {\r\n    dc = e.channel\r\n    dc.onopen = (e) => {\r\n      console.log('ondatachannel', e);\r\n      dc.send('hi back')\r\n    }\r\n\r\n    dc.onmessage = (e) => {\r\n      console.log(e.data);\r\n    }\r\n  }\r\n\r\n  const closedown = () => {\r\n    dc.close()\r\n    type = type.filter(item => item !== 'privateChat')\r\n    // 判断是否还存在其它类型\r\n    if (!type.length) pc.close()\r\n  }\r\n\r\n  // 视频通话需要开启的监听以及挂载的方法\r\n  const videoCallHander = () => {\r\n    // 监听到远端传过来的媒体数据\r\n    pc.ontrack = ontrack\r\n    // 绑定本地媒体流后创建 answer\r\n    getLocalMediaStream().then(() => {\r\n      // create在对方接受邀请后才调用，因为发起方在邀请过程中就需要打开摄像头，而接收方只有在接受后才打开\r\n      // if (mode === 'sender') { createOffer() } else \r\n      if (mode === 'receiver') createAnswer()\r\n    }).catch(err => {\r\n      console.log(err);\r\n      message.error('获取媒体流失败, 请检查摄像头和麦克风权限哦!')\r\n      hangup()\r\n    })\r\n\r\n    // 创建offer的方法\r\n    pc.createOfferFunc = createOffer\r\n    // 挂断视频通话的方法\r\n    pc.hangup = hangup\r\n  }\r\n\r\n  // 私密聊天需要开启的监听以及挂载的方法\r\n  const privateChatHander = () => {\r\n    // 接收端 datachannel\r\n    pc.ondatachannel = ondatachannel\r\n\r\n    // 创建dataChannel的方法\r\n    pc.createDataChannelFunc = createDataChannelFunc\r\n    // 关闭私密聊天的方法\r\n    pc.closedown = closedown\r\n  }\r\n\r\n\r\n  const pc: PC = new RTCPeerConnection(pcOption)\r\n  store.commit('setPC', pc)\r\n  // 修改当前聊天状态为视频通话状态\r\n  // store.commit('setChatStatus', 1)\r\n  store.commit('setChatStatus', { type: 'videoCall', status: true })\r\n\r\n  // 监听\r\n  // 监听 candidate\r\n  pc.onicecandidate = onicecandidate\r\n  // 监听ice connection的状态改变\r\n  pc.oniceconnectionstatechange = oniceconnectionstatechange\r\n\r\n  if (type.indexOf('videoCall') !== -1) {\r\n    videoCallHander()\r\n  }\r\n\r\n  if (type.indexOf('privateChat') !== -1) {\r\n    privateChatHander()\r\n  }\r\n\r\n}\r\n\r\n","import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-560dd598\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"chat\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_session_list = _resolveComponent(\"session-list\")!\n  const _component_chat_window = _resolveComponent(\"chat-window\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(_component_session_list),\n    _createVNode(_component_chat_window, { class: \"chat-window\" })\n  ]))\n}","import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-5377033d\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = {\n  key: 0,\n  class: \"chat-window\"\n}\nconst _hoisted_2 = { class: \"chat-area\" }\nconst _hoisted_3 = { key: 0 }\nconst _hoisted_4 = { key: 1 }\nconst _hoisted_5 = {\n  key: 1,\n  class: \"logo-page\"\n}\nconst _hoisted_6 = [\"src\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_chat_top_bar = _resolveComponent(\"chat-top-bar\")!\n  const _component_chat_dialog = _resolveComponent(\"chat-dialog\")!\n  const _component_input_box = _resolveComponent(\"input-box\")!\n  const _component_noti_dialog = _resolveComponent(\"noti-dialog\")!\n  const _component_video_window = _resolveComponent(\"video-window\")!\n\n  return (_ctx.store.state.currentSession && _ctx.store.state.currentSession.sessionId)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          _createVNode(_component_chat_top_bar),\n          (_ctx.store.state.currentSession.type !== 2)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                _createVNode(_component_chat_dialog),\n                _createVNode(_component_input_box)\n              ]))\n            : (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                _createVNode(_component_noti_dialog)\n              ]))\n        ]),\n        _createVNode(_component_video_window, { class: \"video-area\" })\n      ]))\n    : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n        _createElementVNode(\"img\", {\n          src: require('@/assets/img/logo.svg'),\n          alt: \"\"\n        }, null, 8, _hoisted_6)\n      ]))\n}","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, resolveDynamicComponent as _resolveDynamicComponent, withCtx as _withCtx, createVNode as _createVNode, withModifiers as _withModifiers } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_loading = _resolveComponent(\"loading\")!\n  const _component_scroll_box = _resolveComponent(\"scroll-box\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: \"chat-dialog\",\n    onDrop: _cache[1] || (_cache[1] = _withModifiers(($event: any) => (_ctx.message.info('拖动到输入框可以直接发送文件哦')), [\"prevent\"])),\n    onDragover: _cache[2] || (_cache[2] = _withModifiers(() => {}, [\"prevent\"]))\n  }, [\n    _createVNode(_component_scroll_box, {\n      class: \"scroll-box\",\n      listenHeight: \"\",\n      ref: \"scrollBox\",\n      topDisabled: _ctx.topDisabled,\n      onTouchTop: _cache[0] || (_cache[0] = ($event: any) => (_ctx.getChatList(_ctx.chatList[0].updatedAt)))\n    }, {\n      default: _withCtx(() => [\n        (!_ctx.topDisabled && _ctx.chatList.length >= 30)\n          ? (_openBlock(), _createBlock(_component_loading, { key: 0 }))\n          : _createCommentVNode(\"\", true),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.chatList, (item) => {\n          return (_openBlock(), _createBlock(_resolveDynamicComponent(item.component), {\n            key: item.updatedAt,\n            chat: item,\n            content: item.content\n          }, null, 8, [\"chat\", \"content\"]))\n        }), 128))\n      ]),\n      _: 1\n    }, 8, [\"topDisabled\"])\n  ], 32))\n}","import { ChatItem } from \"@/type\";\r\nimport request from \"@/utils/request\";\r\nimport axios from \"axios\";\r\n\r\n// 获取聊天记录\r\nexport function api_getChatList(\r\n  params: { sessionId: number; lastTime?: number },\r\n  state: { [propname: string]: any }\r\n) {\r\n  return request.get(\"/chats/get_chat_list\", {\r\n    params,\r\n    cancelToken: new axios.CancelToken(function executor(c) {\r\n      state.cancelChatListFunc = c;\r\n    }),\r\n  }) as unknown as getChatListType;\r\n}\r\n\r\ntype getChatListType = {\r\n  code: number,\r\n  list: ChatItem[]\r\n}\r\n\r\n// 请求返回内容类型\r\n// export type getChatListType = {\r\n\r\n// }","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-b606e98a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"user-item\" }\nconst _hoisted_2 = { class: \"item-left-container\" }\nconst _hoisted_3 = { class: \"status\" }\nconst _hoisted_4 = { class: \"item-left\" }\nconst _hoisted_5 = {\n  key: 0,\n  class: \"message-container\"\n}\nconst _hoisted_6 = [\"innerHTML\"]\nconst _hoisted_7 = [\"src\"]\nconst _hoisted_8 = {\n  key: 3,\n  class: \"message-container message\"\n}\nconst _hoisted_9 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", { class: \"iconfont icon-shipin\" }, null, -1))\nconst _hoisted_10 = /*#__PURE__*/_createTextVNode(\"我发起了一个视频通话 \")\nconst _hoisted_11 = [\n  _hoisted_9,\n  _hoisted_10\n]\nconst _hoisted_12 = { class: \"avatar\" }\nconst _hoisted_13 = [\"src\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_loading = _resolveComponent(\"loading\")!\n  const _component_download_card = _resolveComponent(\"download-card\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        (_ctx.chat.status == 'loading')\n          ? (_openBlock(), _createBlock(_component_loading, {\n              key: 0,\n              scale: \"0.5\"\n            }))\n          : (_ctx.chat.status == 'fail')\n            ? (_openBlock(), _createElementBlock(\"i\", {\n                key: 1,\n                class: \"iconfont icon-shuaxin\",\n                title: \"点击重发\",\n                onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.resend && _ctx.resend(...args)))\n              }))\n            : _createCommentVNode(\"\", true)\n      ]),\n      _createElementVNode(\"div\", _hoisted_4, [\n        (_ctx.chat.type == 0)\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n              _createElementVNode(\"pre\", {\n                class: \"message\",\n                innerHTML: _ctx.content\n              }, null, 8, _hoisted_6)\n            ]))\n          : (_ctx.chat.type == 1 || _ctx.chat.type == 3)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 1,\n                class: \"image\",\n                onContextmenu: _cache[3] || (_cache[3] = _withModifiers(($event: any) => (_ctx.rightClickPic($event, _ctx.chat)), [\"right\",\"prevent\"])),\n                style: _normalizeStyle(_ctx.imgStyle)\n              }, [\n                _createElementVNode(\"img\", {\n                  src: _ctx.chat.content,\n                  alt: \"\",\n                  onDragstart: _cache[1] || (_cache[1] = _withModifiers(() => {}, [\"prevent\"])),\n                  onClick: _cache[2] || (_cache[2] = _withModifiers(\n//@ts-ignore\n(...args) => (_ctx.checkImg && _ctx.checkImg(...args)), [\"stop\"]))\n                }, null, 40, _hoisted_7)\n              ], 36))\n            : (_ctx.chat.type == 2)\n              ? (_openBlock(), _createBlock(_component_download_card, {\n                  key: 2,\n                  file: _ctx.chat.content,\n                  fileInfo: _ctx.fileInfo\n                }, null, 8, [\"file\", \"fileInfo\"]))\n              : _createCommentVNode(\"\", true),\n        (_ctx.chat.type == 5)\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, _hoisted_11))\n          : _createCommentVNode(\"\", true)\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_12, [\n      _createElementVNode(\"img\", {\n        src: _ctx.store.state.userInfo.avatar,\n        alt: \"\"\n      }, null, 8, _hoisted_13)\n    ])\n  ]))\n}","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-3d860b10\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = [\"title\"]\nconst _hoisted_2 = { class: \"file-info\" }\nconst _hoisted_3 = { class: \"file-name\" }\nconst _hoisted_4 = { class: \"file-size\" }\nconst _hoisted_5 = { class: \"file-cover\" }\nconst _hoisted_6 = [\"src\"]\nconst _hoisted_7 = {\n  key: 0,\n  class: \"progress-bar\"\n}\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: \"download-card\",\n    onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.download && _ctx.download(...args))),\n    title: _ctx.fileInfo.fileName\n  }, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", _hoisted_3, _toDisplayString(_ctx.fileInfo.fileName), 1),\n      _createElementVNode(\"div\", _hoisted_4, _toDisplayString(_ctx.sizeShow), 1)\n    ]),\n    _createElementVNode(\"div\", _hoisted_5, [\n      _createElementVNode(\"img\", {\n        src: require('@/assets/img/fileImg.png'),\n        alt: \"\"\n      }, null, 8, _hoisted_6)\n    ]),\n    (_ctx.downing)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n          _createElementVNode(\"div\", {\n            class: \"done-part\",\n            style: _normalizeStyle(`width:${_ctx.progress}%;`)\n          }, null, 4)\n        ]))\n      : _createCommentVNode(\"\", true)\n  ], 8, _hoisted_1))\n}","\r\nimport axios from 'axios'\r\nimport { reactive, toRefs } from '@vue/reactivity'\r\nimport { message } from 'ant-design-vue'\r\nimport { computed, defineComponent } from '@vue/runtime-core'\r\n\r\nimport { FileInfo } from '@/type'\r\n\r\nexport default defineComponent({\r\n  name: 'download-card',\r\n  props: {\r\n    fileInfo: {\r\n      type: Object,\r\n      default: (): FileInfo => {\r\n        return { fileName: '', size: 0 }\r\n      },\r\n    },\r\n    file: String,\r\n  },\r\n  setup(props) {\r\n    const state = reactive({\r\n      // 下载进度\r\n      progress: 0,\r\n      // 是否正在下载\r\n      downing: false,\r\n    })\r\n    const compute = {\r\n      sizeShow: computed(() => {\r\n        let size = props.fileInfo?.size\r\n        if (size < 1024) {\r\n          return size + 'B'\r\n        } else if (size < 1024 * 1024) {\r\n          return (size / 1024).toFixed(2) + 'K'\r\n        } else {\r\n          return (size / 1024 / 1024).toFixed(2) + 'M'\r\n        }\r\n      }),\r\n    }\r\n\r\n    let cancelFunc: any = null\r\n\r\n    // methods\r\n    // 点击下载的回调\r\n    const download = () => {\r\n      if (state.downing && cancelFunc) {\r\n        // 取消下载\r\n        state.downing = false\r\n        message.info('取消下载')\r\n        cancelFunc('cancel download')\r\n      } else if (!state.downing) {\r\n        // 下载\r\n        state.downing = true\r\n        message.info('开始下载, 再次点击可取消下载')\r\n        let isLocal = /^blob/.test(props.file as string)\r\n        if (isLocal) {\r\n          createTag(props.file as string)\r\n        } else {\r\n          let src = (props.file as string).replace(process.env.VUE_APP_DOWNLOAD, '/download')\r\n          axios\r\n            .get(src, {\r\n              responseType: 'blob',\r\n              onDownloadProgress: (progressEvent) => {\r\n                state.progress = (progressEvent.loaded / progressEvent.total) * 100\r\n              },\r\n              cancelToken: new axios.CancelToken((c) => {\r\n                cancelFunc = c\r\n              }),\r\n            })\r\n            .then((res) => {\r\n              let blob = res.data\r\n              let src = URL.createObjectURL(blob)\r\n              createTag(src)\r\n            })\r\n            .catch((err) => {\r\n              if (err.message == 'cancel download') return\r\n              // console.log(err);\r\n              state.downing = false\r\n              message.error('下载失败!')\r\n            })\r\n        }\r\n      }\r\n\r\n      // 创建a标签并下载\r\n      function createTag(src: string) {\r\n        let a = document.createElement('a')\r\n        a.href = src\r\n        a.download = props.fileInfo?.fileName\r\n\r\n        a.click()\r\n        message.success('下载成功')\r\n        state.downing = false\r\n\r\n        URL.revokeObjectURL(src)\r\n        // a = null;\r\n      }\r\n    }\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      ...compute,\r\n      download,\r\n    }\r\n  },\r\n})\r\n","import { render } from \"./DownloadCard.vue?vue&type=template&id=3d860b10&scoped=true&ts=true\"\nimport script from \"./DownloadCard.vue?vue&type=script&lang=ts\"\nexport * from \"./DownloadCard.vue?vue&type=script&lang=ts\"\n\nimport \"./DownloadCard.vue?vue&type=style&index=0&id=3d860b10&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3d860b10\"]])\n\nexport default __exports__","\r\nimport { transToTag } from '@/utils/utils'\r\nimport DownloadCard from '@/components/DownloadCard.vue'\r\nimport Loading from '@/components/Loading.vue'\r\n\r\nimport Pubsub from 'pubsub-js'\r\nimport { computed, defineComponent, onBeforeUnmount, onMounted, PropType } from 'vue'\r\nimport { message } from 'ant-design-vue'\r\n\r\n// import { Chat } from './chatItem'\r\nimport { useStore } from 'vuex'\r\nimport { ChatItem } from '@/type'\r\n\r\nexport default defineComponent({\r\n  name: 'user-item',\r\n  components: { DownloadCard, Loading },\r\n  props: {\r\n    chat: {\r\n      type: Object as PropType<ChatItem>,\r\n      default: null,\r\n    },\r\n  },\r\n  setup(props) {\r\n    const store = useStore()\r\n    const compute = {\r\n      content: computed(() => transToTag(props.chat.content)),\r\n      imgStyle: computed(() => {\r\n        // 如果是blob开头, 说明是刚发送的图片\r\n        if (/^blob:/.test(props.chat.content)) return ''\r\n        let reg = /\\??size=([0-9]{1,3}x[0-9]{1,3})&?/\r\n        let arr = (props.chat.content.match(reg) as RegExpMatchArray)[1].split('x')\r\n        return `width:${arr[0]}px;height:${arr[1]}px;`\r\n      }),\r\n      fileInfo: computed(() => {\r\n        if (/^blob:/.test(props.chat.content)) return props.chat.fileInfo\r\n        return JSON.parse(props.chat.others as unknown as string)\r\n      }),\r\n    }\r\n    let timer: number | null = null\r\n\r\n    // 生命周期\r\n    onMounted(() => {\r\n      createTimer()\r\n    })\r\n\r\n    onBeforeUnmount(() => {\r\n      timer && clearTimeout(timer)\r\n    })\r\n\r\n    // methods\r\n    // 点击重发的回调\r\n    const resend = () => {\r\n      let chatItem = {\r\n        content: props.chat.file,\r\n        receiverId: props.chat.receiverId,\r\n        uuid: props.chat.uuid,\r\n        type: props.chat.type,\r\n        sessionId: props.chat.sessionId,\r\n        fileInfo: props.chat.fileInfo,\r\n      }\r\n      window.$socket.emit('chat', chatItem)\r\n      // 直接改props就报语法错了 这里赋值下再改\r\n      let chat = props.chat\r\n      chat.status = 'loading'\r\n      createTimer()\r\n    }\r\n\r\n    // 右键点击图片的回调\r\n    const rightClickPic = (e: MouseEvent, chat: ChatItem) => {\r\n      if (chat.status === 'fail' || chat.status === 'loading') {\r\n        message.info(`图片当前处于${chat.status}阶段, 无法操作`)\r\n        return\r\n      }\r\n      Pubsub.publish('rightMenu', {\r\n        position: { x: e.x, y: e.y },\r\n        menuList: [\r\n          {\r\n            content: '收藏至自定义表情',\r\n            callback: () => {\r\n              Pubsub.publish('addEmoticon', chat.content)\r\n            },\r\n          },\r\n        ],\r\n      })\r\n    }\r\n\r\n    // 设置超时的定时器\r\n    const createTimer = () => {\r\n      if (props.chat.status == 'loading') {\r\n        timer = setTimeout(() => {\r\n          if (props.chat.status == 'loading') {\r\n            let chat = props.chat\r\n            chat.status = 'fail'\r\n          }\r\n          timer = null\r\n        }, 10000)\r\n      }\r\n    }\r\n\r\n    const checkImg = (e: MouseEvent) => {\r\n      Pubsub.publish('viewPicture', e.target)\r\n    }\r\n\r\n    return {\r\n      checkImg,\r\n      rightClickPic,\r\n      resend,\r\n      ...compute,\r\n      store,\r\n    }\r\n  },\r\n})\r\n","import { render } from \"./userItem.vue?vue&type=template&id=b606e98a&scoped=true&ts=true\"\nimport script from \"./userItem.vue?vue&type=script&lang=ts\"\nexport * from \"./userItem.vue?vue&type=script&lang=ts\"\n\nimport \"./userItem.vue?vue&type=style&index=0&id=b606e98a&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-b606e98a\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle, resolveComponent as _resolveComponent, createBlock as _createBlock, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-7dd0d00a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"talker-item\" }\nconst _hoisted_2 = { class: \"avatar\" }\nconst _hoisted_3 = [\"src\"]\nconst _hoisted_4 = { class: \"item-right\" }\nconst _hoisted_5 = {\n  key: 0,\n  class: \"item-right-top\"\n}\nconst _hoisted_6 = { class: \"user-name\" }\nconst _hoisted_7 = { class: \"time\" }\nconst _hoisted_8 = {\n  key: 1,\n  class: \"message-container\"\n}\nconst _hoisted_9 = [\"innerHTML\"]\nconst _hoisted_10 = [\"src\"]\nconst _hoisted_11 = {\n  key: 4,\n  class: \"message-container message\"\n}\nconst _hoisted_12 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", { class: \"iconfont icon-shipin\" }, null, -1))\nconst _hoisted_13 = /*#__PURE__*/_createTextVNode(\"对方发起了一个视频邀请 \")\nconst _hoisted_14 = [\n  _hoisted_12,\n  _hoisted_13\n]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_download_card = _resolveComponent(\"download-card\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"img\", {\n        src: _ctx.userInfo?.avatar,\n        alt: \"\"\n      }, null, 8, _hoisted_3)\n    ]),\n    _createElementVNode(\"div\", _hoisted_4, [\n      (_ctx.chat?.sort === 1)\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n            _createElementVNode(\"span\", _hoisted_6, _toDisplayString(_ctx.userInfo?.userName), 1),\n            _createElementVNode(\"span\", _hoisted_7, _toDisplayString(_ctx.chat?.updatedAt), 1)\n          ]))\n        : _createCommentVNode(\"\", true),\n      (_ctx.chat?.type == 0)\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n            _createElementVNode(\"pre\", {\n              class: \"message\",\n              innerHTML: _ctx.content\n            }, null, 8, _hoisted_9)\n          ]))\n        : (_ctx.chat.type == 1 || _ctx.chat.type == 3)\n          ? (_openBlock(), _createElementBlock(\"div\", {\n              key: 2,\n              class: \"image\",\n              onContextmenu: _cache[2] || (_cache[2] = _withModifiers(($event: any) => (_ctx.rightClickPic($event, _ctx.chat.content)), [\"right\",\"prevent\"])),\n              style: _normalizeStyle(_ctx.imgStyle)\n            }, [\n              _createElementVNode(\"img\", {\n                src: _ctx.chat.content,\n                alt: \"\",\n                onDragstart: _cache[0] || (_cache[0] = _withModifiers(() => {}, [\"prevent\"])),\n                onClick: _cache[1] || (_cache[1] = _withModifiers(\n//@ts-ignore\n(...args) => (_ctx.checkImg && _ctx.checkImg(...args)), [\"stop\"]))\n              }, null, 40, _hoisted_10)\n            ], 36))\n          : (_ctx.chat.type == 2)\n            ? (_openBlock(), _createBlock(_component_download_card, {\n                key: 3,\n                file: _ctx.chat.content,\n                fileInfo: _ctx.fileInfo\n              }, null, 8, [\"file\", \"fileInfo\"]))\n            : _createCommentVNode(\"\", true),\n      (_ctx.chat.type == 5)\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, _hoisted_14))\n        : _createCommentVNode(\"\", true)\n    ])\n  ]))\n}","\r\nimport { transToTag } from '@/utils/utils'\r\nimport DownloadCard from '@/components/DownloadCard.vue'\r\n\r\nimport Pubsub from 'pubsub-js'\r\nimport { reactive, computed, toRefs, onMounted, defineComponent } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ChatItem, User } from '@/type'\r\n\r\nexport default defineComponent({\r\n  name: 'talker-item',\r\n  components: { DownloadCard },\r\n  props: {\r\n    chat: {\r\n      type: Object,\r\n      default: (): ChatItem | null => {\r\n        return null\r\n      },\r\n    },\r\n  },\r\n  setup(props) {\r\n    const store = useStore()\r\n    const state: State = reactive({\r\n      // 用户信息\r\n      userInfo: null,\r\n    })\r\n    const compute = {\r\n      content: computed(() => transToTag(props.chat.content)),\r\n      imgStyle: computed(() => {\r\n        // 如果是blob开头, 说明是刚发送的图片\r\n        if (/^blob:/.test(props.chat.content)) return ''\r\n        let reg = /\\??size=([0-9]{1,3}x[0-9]{1,3})&?/\r\n        let arr = props.chat.content.match(reg)[1].split('x')\r\n        return `width:${arr[0]}px;height:${arr[1]}px;`\r\n      }),\r\n      fileInfo: computed(() => {\r\n        if (/^blob:/.test(props.chat.content)) return props.chat.fileInfo\r\n        return JSON.parse(props.chat.others)\r\n      }),\r\n    }\r\n\r\n    // 生命周期\r\n    onMounted(() => {\r\n      // 如果是私聊  用户信息可以直接从session里面取\r\n      if (store.state.currentSession.type === 0) {\r\n        state.userInfo = store.state.currentSession.user\r\n      }\r\n    })\r\n\r\n    // methods\r\n    // 右键点击图片的回调\r\n    const rightClickPic = (e: MouseEvent, src: string) => {\r\n      Pubsub.publish('rightMenu', {\r\n        position: { x: e.x, y: e.y },\r\n        menuList: [\r\n          {\r\n            content: '收藏至自定义表情',\r\n            callback: () => {\r\n              Pubsub.publish('addEmoticon', src)\r\n            },\r\n          },\r\n        ],\r\n      })\r\n    }\r\n\r\n    const checkImg = (e: MouseEvent) => {\r\n      Pubsub.publish('viewPicture', e.target)\r\n    }\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      ...compute,\r\n      rightClickPic,\r\n      checkImg,\r\n    }\r\n  },\r\n})\r\n\r\ntype State = {\r\n  userInfo: User | null\r\n}\r\n","import { render } from \"./talkerItem.vue?vue&type=template&id=7dd0d00a&scoped=true&ts=true\"\nimport script from \"./talkerItem.vue?vue&type=script&lang=ts\"\nexport * from \"./talkerItem.vue?vue&type=script&lang=ts\"\n\nimport \"./talkerItem.vue?vue&type=style&index=0&id=7dd0d00a&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7dd0d00a\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-c83a49ee\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"time-tag\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"span\", null, _toDisplayString(_ctx.content), 1)\n  ]))\n}","\r\nimport { defineComponent } from '@vue/runtime-core'\r\n\r\nexport default defineComponent({\r\n  props: {\r\n    content: String,\r\n  },\r\n})\r\n","import { render } from \"./NotificationTag.vue?vue&type=template&id=c83a49ee&scoped=true&ts=true\"\nimport script from \"./NotificationTag.vue?vue&type=script&lang=ts\"\nexport * from \"./NotificationTag.vue?vue&type=script&lang=ts\"\n\nimport \"./NotificationTag.vue?vue&type=style&index=0&id=c83a49ee&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-c83a49ee\"]])\n\nexport default __exports__","\r\nimport { api_getChatList } from '@/api/chat'\r\nimport userItem from './children/userItem.vue'\r\nimport TalkerItem from './children/talkerItem.vue'\r\nimport NotificationTag from './children/NotificationTag.vue'\r\nimport ScrollBox from '@/components/ScrollBox.vue'\r\nimport Loading from '@/components/Loading.vue'\r\n\r\nimport moment from 'moment'\r\nimport { reactive, toRefs } from '@vue/reactivity'\r\nimport useSubscribe from '@/hooks/subscribe'\r\n\r\nimport {\r\n  onBeforeUnmount,\r\n  onMounted,\r\n  nextTick,\r\n  getCurrentInstance,\r\n  watch,\r\n  onBeforeMount,\r\n  ComponentInternalInstance,\r\n  defineComponent,\r\n  // ref,\r\n} from 'vue'\r\nimport { useStore } from 'vuex'\r\n\r\nimport { Canceler } from 'axios'\r\nimport { TimeTag, SuccessMsg, FailMsg, ReceiveMsg, ChatItem } from '@/type'\r\nimport { message } from 'ant-design-vue'\r\n\r\nexport default defineComponent({\r\n  components: { userItem, TalkerItem, ScrollBox, Loading, NotificationTag },\r\n  name: 'chat-dialog',\r\n  props: {\r\n    // 当前的sessionId\r\n    sessionId: Number,\r\n  },\r\n  setup() {\r\n    const store = useStore()\r\n    const { proxy } = getCurrentInstance() as ComponentInternalInstance\r\n    const state: State = reactive({\r\n      chatList: [],\r\n      // 禁止触顶\r\n      topDisabled: false,\r\n      // 取消请求聊天列表的方法\r\n      cancelChatListFunc: null,\r\n    })\r\n    // let scrollBox = ref(null)\r\n    let scrollBox: typeof ScrollBox | null = null\r\n\r\n    let timeTagFunc: ((item1: ChatItem | ReceiveMsg, item2: ChatItem | ReceiveMsg) => TimeTag | undefined) | null = null\r\n\r\n    // 生命周期\r\n    onBeforeMount(() => {\r\n      timeTagFunc = createTimeTag()\r\n\r\n      useSubscribe([\r\n        // 监听输入框发送的消息\r\n        { msgName: 'sendMsg', callback: sendMsg },\r\n        // 接收其它用户发送的消息\r\n        { msgName: 'chat', callback: receiveChat },\r\n        // 发送消息成功\r\n        { msgName: 'sendMsgSuccess', callback: sendMsgSuccess },\r\n        // 发送消息失败\r\n        { msgName: 'sendMsgFail', callback: sendMsgFail },\r\n      ])\r\n    })\r\n    onMounted(() => {\r\n      // scrollBox=scrollBox.value && (scrollBox.value as typeof ScrollBox)\r\n      scrollBox = proxy && (proxy.$refs.scrollBox as typeof ScrollBox)\r\n      // 第一次创建时直接请求聊天数据\r\n      getChatList()\r\n    })\r\n\r\n    onBeforeUnmount(() => {\r\n      state.cancelChatListFunc && state.cancelChatListFunc()\r\n    })\r\n\r\n    // methods\r\n    // 请求\r\n    // 请求聊天记录\r\n    const getChatList = async (lastTime?: number) => {\r\n      state.topDisabled = true\r\n      let res = await api_getChatList({ sessionId: store.state.currentSession.sessionId, lastTime }, state)\r\n      if (res) {\r\n        let arr = insertTimeTag(res.list)\r\n\r\n        if (!lastTime) {\r\n          state.chatList.unshift(...arr)\r\n          // 没传时间，则是第一次获取聊天记录，滚动到底部\r\n          scrollToFunc('instant')\r\n        } else {\r\n          scrollBox &&\r\n            scrollBox.keepHeight(() => {\r\n              state.chatList.unshift(...arr)\r\n            })\r\n        }\r\n\r\n        // 聊天记录一次请求30条，小于30条说明没有更多聊天数据了\r\n        state.topDisabled = arr.length < 30\r\n        state.cancelChatListFunc = null\r\n      }\r\n    }\r\n\r\n    // 输入框发送消息的回调\r\n    const sendMsg = (name: string, chatItem: ChatItem) => {\r\n      let list = state.chatList\r\n      let timeTag = timeTagFunc && timeTagFunc(chatItem, list[list.length - 1] as ChatItem)\r\n      if (timeTag) list.push(timeTag)\r\n      chatItem.component = 'user-item'\r\n      list.push(chatItem)\r\n      // 自己发消息，直接滚到底部\r\n      // 读取本地图片并加载需要一定时间, 监听img的onload事件是更好的做法, 但是这里不想弄了, 定时器凑合一下\r\n      let timer = setTimeout(() => {\r\n        scrollToFunc()\r\n        clearTimeout(timer)\r\n        timer = -1\r\n      }, 50)\r\n    }\r\n\r\n    // 接收别的用户发送的消息\r\n    const receiveChat = (name: string, msg: ReceiveMsg) => {\r\n      let list = state.chatList\r\n      // 先判断是否是当前会话\r\n      if (msg.sessionId !== store.state.currentSession.sessionId) return\r\n      if (msg.type == 4) {\r\n        msg.component = 'notification-tag'\r\n      } else {\r\n        let timeTag = timeTagFunc && timeTagFunc(msg, list[list.length - 1] as ChatItem | ReceiveMsg)\r\n        if (timeTag) list.push(timeTag)\r\n        msg.component = msg.talkerId == store.state.currentSession.receiverId ? 'talker-item' : 'user-item'\r\n      }\r\n      list.push(msg)\r\n      // 判断当前是否离底，再进行滚动, 100表示100px内都是触底范围\r\n      scrollBox && scrollBox.getIsBottom(100) && scrollToFunc()\r\n    }\r\n\r\n    // 消息发送成功后的回调\r\n    const sendMsgSuccess = (name: string, msg: SuccessMsg) => {\r\n      let list = state.chatList\r\n      // 倒序遍历数组，因为刚发送的消息一般接近底部\r\n      for (let i = list.length - 1; i >= 0; i--) {\r\n        let item = list[i] as ChatItem\r\n        if (item.uuid === msg.uuid) {\r\n          // this.chatList[i] = msg\r\n          item.updatedAt = msg.updatedAt\r\n          item.status = 'success'\r\n          // console.log(this.chatList[i]);\r\n          if (item.type === 1) {\r\n            item.content = msg.content\r\n          }\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    // 发送消息失败的回调\r\n    const sendMsgFail = (name: string, msg: FailMsg) => {\r\n      let list = state.chatList\r\n      // 倒序遍历数组，因为刚发送的消息一般接近底部\r\n      for (let i = list.length - 1; i >= 0; i--) {\r\n        let item = list[i] as ChatItem\r\n        if (item.uuid === msg.uuid) {\r\n          item.status = 'fail'\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    // 聊天框滚动到底部\r\n    const scrollToFunc = (behavior?: string) => {\r\n      nextTick(() => {\r\n        if (proxy && !proxy.$refs.scrollBox) return\r\n        scrollBox && scrollBox.scrollToFunc(behavior)\r\n      })\r\n    }\r\n\r\n    // 根据消息时间插入时间节点标签\r\n    const insertTimeTag = (chatList: ChatItem[]) => {\r\n      let arr: (ChatItem | TimeTag)[] = []\r\n      let userId = store.state.userInfo.id\r\n\r\n      chatList.forEach((item, index, list) => {\r\n        // 通知\r\n        if (item.type == 4) {\r\n          item['component'] = 'notification-tag'\r\n\r\n          switch (item.content) {\r\n            case 'deleteFriend':\r\n              // 删除好友通知\r\n              item.content = (item.senderId == userId ? '您已与对方' : '对方已与您') + '解除好友关系'\r\n              break\r\n            default:\r\n              break\r\n          }\r\n        } else {\r\n          // 其它类型信息\r\n          if (item.senderId == userId) {\r\n            item['component'] = 'user-item'\r\n          } else {\r\n            item['component'] = 'talker-item'\r\n          }\r\n        }\r\n        arr.unshift(item)\r\n\r\n        let timeTag = index < list.length - 1 && timeTagFunc && timeTagFunc(item, list[index + 1])\r\n        if (timeTag) arr.unshift(timeTag)\r\n      })\r\n      return arr\r\n    }\r\n\r\n    // 将本日和本周时间戳闭包\r\n    const createTimeTag = () => {\r\n      // 当天0点时间戳\r\n      let today = moment().startOf('day').valueOf()\r\n      let thisWeek =\r\n        moment()\r\n          .week(moment().week() - 1)\r\n          .startOf('week')\r\n          .valueOf() + 86400000\r\n\r\n      return function (item1: ChatItem | ReceiveMsg, item2: ChatItem | ReceiveMsg) {\r\n        // 间隔超过5分钟显示时间节点标签\r\n        let updatedAt_item1 = parseInt(item1.updatedAt)\r\n        let updatedAt_item2 = parseInt(item2.updatedAt)\r\n        if (updatedAt_item1 - updatedAt_item2 > 5 * 60000) {\r\n          let time = null\r\n          if (updatedAt_item1 > today) time = moment(updatedAt_item1).format('HH:mm')\r\n          else if (updatedAt_item1 > thisWeek) time = moment(updatedAt_item1).locale('zh-cn').format('dddd HH:mm')\r\n          else time = moment(updatedAt_item1).format('YYYY年MM月DD日 HH:mm')\r\n\r\n          return { content: time, component: 'notification-tag', updatedAt: updatedAt_item1.toString() }\r\n        }\r\n      }\r\n    }\r\n\r\n    // watch\r\n    watch(\r\n      () => store.state.currentSession,\r\n      (current) => {\r\n        state.chatList = []\r\n        state.cancelChatListFunc && state.cancelChatListFunc('cancelChatListFunc')\r\n        if (current.receiverId !== -1) {\r\n          // receiverId为 -1 时是系统通知\r\n          getChatList()\r\n        }\r\n      }\r\n    )\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      getChatList,\r\n      message,\r\n    }\r\n  },\r\n})\r\n\r\ntype State = {\r\n  chatList: (ChatItem | TimeTag | ReceiveMsg)[]\r\n  topDisabled: boolean\r\n  cancelChatListFunc: null | Canceler\r\n}\r\n","import { render } from \"./ChatDialog.vue?vue&type=template&id=104f0e3f&scoped=true&ts=true\"\nimport script from \"./ChatDialog.vue?vue&type=script&lang=ts\"\nexport * from \"./ChatDialog.vue?vue&type=script&lang=ts\"\n\nimport \"./ChatDialog.vue?vue&type=style&index=0&id=104f0e3f&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-104f0e3f\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-eed66ecc\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"chat-top-bar\" }\nconst _hoisted_2 = { class: \"bar-left\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, _toDisplayString($setup.store.state.currentSession.sessionName), 1)\n  ]))\n}","\r\n  import { useStore } from 'vuex'\r\n  export default {\r\n    name: \"chat-top-bar\",\r\n    setup() {\r\n      const store = useStore()\r\n      return {\r\n        store,\r\n      }\r\n    }\r\n  }\r\n","import { render } from \"./ChatTopBar.vue?vue&type=template&id=eed66ecc&scoped=true&ts=true\"\nimport script from \"./ChatTopBar.vue?vue&type=script&lang=ts\"\nexport * from \"./ChatTopBar.vue?vue&type=script&lang=ts\"\n\nimport \"./ChatTopBar.vue?vue&type=style&index=0&id=eed66ecc&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-eed66ecc\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-2096d6d8\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"function-bar\" }\nconst _hoisted_2 = { class: \"bar-left\" }\nconst _hoisted_3 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", { class: \"iconfont icon-biaoqing-xue\" }, null, -1))\nconst _hoisted_4 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", { class: \"iconfont icon-wenjianjiawenjianguanli\" }, null, -1))\nconst _hoisted_5 = { class: \"bar-right\" }\nconst _hoisted_6 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", { style: { color: 'white' } }, \"点对点私密聊天, 聊天信息将不会经过服务器, 且不会被保存\", -1))\nconst _hoisted_7 = { class: \"bottom-bar\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_emoji_dialog = _resolveComponent(\"emoji-dialog\")!\n  const _component_upload_cmp = _resolveComponent(\"upload-cmp\")!\n  const _component_a_tooltip = _resolveComponent(\"a-tooltip\")!\n  const _component_chat_input = _resolveComponent(\"chat-input\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: \"input-box\",\n    tabindex: \"1\",\n    onDrop: _cache[3] || (_cache[3] = _withModifiers(\n//@ts-ignore\n(...args) => ($setup.dropFile && $setup.dropFile(...args)), [\"prevent\"])),\n    onDragover: _cache[4] || (_cache[4] = _withModifiers(() => {}, [\"prevent\"]))\n  }, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createElementVNode(\"div\", _hoisted_2, [\n        _createVNode(_component_emoji_dialog, { onSelectEmoji: $setup.selectEmoji }, {\n          default: _withCtx(() => [\n            _hoisted_3\n          ]),\n          _: 1\n        }, 8, [\"onSelectEmoji\"]),\n        _createVNode(_component_upload_cmp, { onUploadFile: $setup.uploadFile }, {\n          default: _withCtx(() => [\n            _hoisted_4\n          ]),\n          _: 1\n        }, 8, [\"onUploadFile\"])\n      ]),\n      _createElementVNode(\"div\", _hoisted_5, [\n        _createVNode(_component_a_tooltip, { placement: \"topLeft\" }, {\n          title: _withCtx(() => [\n            _hoisted_6\n          ]),\n          default: _withCtx(() => [\n            _createElementVNode(\"i\", {\n              class: \"iconfont icon-jiami\",\n              onClick: _cache[0] || (_cache[0] = ($event: any) => ($setup.message.info('私密聊天正在火速开发中哦!')))\n            })\n          ]),\n          _: 1\n        }),\n        _createElementVNode(\"i\", {\n          class: \"iconfont icon-shipin\",\n          onClick: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => ($setup.videoHandler && $setup.videoHandler(...args)))\n        })\n      ])\n    ]),\n    _createVNode(_component_chat_input, {\n      class: \"chat-input-cmp\",\n      ref: \"chatInput\",\n      onSendMsg: $setup.sendMsg,\n      onUploadFile: $setup.uploadFile\n    }, null, 8, [\"onSendMsg\", \"onUploadFile\"]),\n    _createElementVNode(\"div\", _hoisted_7, [\n      _createElementVNode(\"div\", {\n        class: \"send\",\n        onClick: _cache[2] || (_cache[2] = ($event: any) => ($setup.proxy.$refs.chatInput.sendMsg()))\n      }, \"发送\")\n    ])\n  ], 32))\n}","import { withModifiers as _withModifiers, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-dd70b656\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"input-container\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", {\n      class: \"chat-input\",\n      contenteditable: \"\",\n      onMousedown: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.getLastLocation && _ctx.getLastLocation(...args))),\n      onKeydown: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.keydownFunc && _ctx.keydownFunc(...args))),\n      onKeyup: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.keyupFunc && _ctx.keyupFunc(...args))),\n      onPaste: _cache[3] || (_cache[3] = _withModifiers(\n//@ts-ignore\n(...args) => (_ctx.pasteFunc && _ctx.pasteFunc(...args)), [\"prevent\"])),\n      onInput: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.inputFunc && _ctx.inputFunc(...args)))\n    }, null, 32)\n  ]))\n}","\r\nimport { transToTag } from '@/utils/utils'\r\nimport { reactive, toRefs } from '@vue/reactivity'\r\nimport { ComponentInternalInstance, defineComponent, getCurrentInstance, onMounted } from '@vue/runtime-core'\r\nimport { message } from 'ant-design-vue'\r\n\r\nexport default defineComponent({\r\n  name: 'chat-input',\r\n  setup(props, { emit }) {\r\n    const { proxy } = getCurrentInstance() as ComponentInternalInstance\r\n    const state = reactive({\r\n      content: '',\r\n    })\r\n    // 光标最后的位置\r\n    let lastLocation: Range | null = null,\r\n      chatInput: HTMLElement,\r\n      selection: Selection | null\r\n\r\n    // 生命周期\r\n    onMounted(() => {\r\n      chatInput = proxy && proxy.$el.querySelector('.chat-input')\r\n      selection = getSelection()\r\n    })\r\n\r\n    // methods\r\n    // api\r\n    // 插入表情\r\n    const addEmoji = (index: number) => {\r\n      lastLocation || getLastLocation()\r\n\r\n      let emoji = document.createElement('img')\r\n      emoji.src =\r\n        'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAApJREFUCNdjYAAAAAIAAeIhvDMAAAAASUVORK5CYII='\r\n      emoji.alt = `[emoji-${index}]`\r\n      emoji.draggable = false\r\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n      // @ts-ignore\r\n      emoji.style = `\r\n        height: 22px;\r\n        width: 24px;\r\n        background: url(${require('@/assets/emoji/emoji.png')});\r\n        background-repeat: no-repeat;\r\n        background-size: 24px;\r\n        margin:0 1px;\r\n        background-position:0 ${-24 * index}px;\r\n        vertical-align: text-bottom;\r\n      `\r\n      insertNode(emoji)\r\n    }\r\n\r\n    // 发送消息\r\n    const sendMsg = () => {\r\n      let content = chatInput.innerHTML.trim()\r\n      if (content === '') {\r\n        message.warn('发送内容不能为空哦')\r\n        return\r\n      } else if (content.length > 5000) {\r\n        message.warn('发送内容长度不能超过5000哦')\r\n        return\r\n      }\r\n\r\n      content = getAltValue(content)\r\n      content = content.replace(/</gi, '&lt;').replace(/>/gi, '&gt;')\r\n\r\n      emit('sendMsg', content)\r\n      chatInput.innerHTML = ''\r\n    }\r\n\r\n    // 事件回调\r\n    // 粘贴事件\r\n    const pasteFunc = (e: ClipboardEvent) => {\r\n      // console.log(e.clipboardData.files[0]);\r\n      let file = e.clipboardData?.files[0]\r\n      if (file) {\r\n        emit('uploadFile', file)\r\n        return\r\n      }\r\n\r\n      // 去除样式\r\n      let content = e.clipboardData?.getData('text')\r\n      // 转译标签，防止用户手动插入标签\r\n      content = content?.replace(/</gi, '&lt;').replace(/>/gi, '&gt;')\r\n\r\n      content = content && transToTag(content)\r\n      // 将文本插回光标处\r\n      document.execCommand('insertHTML', false, content)\r\n      inputFunc()\r\n    }\r\n\r\n    // 输入的回调\r\n    const inputFunc = () => {\r\n      getLastLocation()\r\n\r\n      // contenteditable末尾换行必须至少存在一个\\n\r\n      if (!/\\n$/.test(chatInput.innerHTML)) {\r\n        let node = document.createTextNode('\\n')\r\n        chatInput.appendChild(node)\r\n      }\r\n    }\r\n\r\n    // 键盘按下的回调\r\n    const keydownFunc = (e: KeyboardEvent) => {\r\n      let kc = e.keyCode\r\n      if (e.ctrlKey && kc === 13) {\r\n        e.preventDefault()\r\n        let node = document.createTextNode('\\n')\r\n        insertNode(node)\r\n        chatInput.scrollTo({\r\n          top: chatInput.scrollTop + 20,\r\n          behavior: 'smooth',\r\n        })\r\n      } else if (kc === 13) {\r\n        e.preventDefault()\r\n        sendMsg()\r\n      }\r\n    }\r\n\r\n    // 键盘弹起的回调\r\n    const keyupFunc = (e: KeyboardEvent) => {\r\n      let kc = e.keyCode\r\n      if (kc >= 37 && kc <= 40) {\r\n        getLastLocation()\r\n      } else if (kc === 8) {\r\n        // 退格在删完最后一行内容时会产生br\r\n        if (/<br>/g.test(chatInput.innerHTML)) {\r\n          chatInput.innerHTML = chatInput.innerHTML.replace(/<br>/g, '')\r\n          let range = window.getSelection() // 创建range\r\n          range?.selectAllChildren(chatInput) // range 选择obj下所有子内容\r\n          range?.collapseToEnd() // 光标移至最后\r\n        }\r\n      }\r\n    }\r\n\r\n    // 方法\r\n    // 记录光标的位置\r\n    const getLastLocation = () => {\r\n      chatInput.focus()\r\n      lastLocation = selection?.getRangeAt(0) as Range\r\n      lastLocation.collapse(false)\r\n    }\r\n\r\n    // 插入节点\r\n    const insertNode = (node: Node) => {\r\n      selection?.removeAllRanges()\r\n      lastLocation && selection?.addRange(lastLocation)\r\n\r\n      lastLocation?.deleteContents()\r\n      lastLocation?.insertNode(node)\r\n      inputFunc()\r\n    }\r\n\r\n    // 获取img标签中alt的值\r\n    const getAltValue = (content: string) => {\r\n      let reg = /<img.*?alt=\"(.*?)\".*?>/g\r\n      return content.replace(reg, '$1')\r\n    }\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      addEmoji,\r\n      pasteFunc,\r\n      inputFunc,\r\n      keydownFunc,\r\n      keyupFunc,\r\n      getLastLocation,\r\n    }\r\n  },\r\n})\r\n","import { render } from \"./ChatInput.vue?vue&type=template&id=dd70b656&scoped=true&ts=true\"\nimport script from \"./ChatInput.vue?vue&type=script&lang=ts\"\nexport * from \"./ChatInput.vue?vue&type=script&lang=ts\"\n\nimport \"./ChatInput.vue?vue&type=style&index=0&id=dd70b656&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-dd70b656\"]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, vShow as _vShow, createElementVNode as _createElementVNode, withDirectives as _withDirectives, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, withModifiers as _withModifiers, normalizeClass as _normalizeClass, renderSlot as _renderSlot, resolveDirective as _resolveDirective, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-dc32a2d6\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"emoji-dialog\" }\nconst _hoisted_2 = { class: \"emoji-container\" }\nconst _hoisted_3 = { class: \"emoticon-tab\" }\nconst _hoisted_4 = [\"onClick\"]\nconst _hoisted_5 = { class: \"emoticon-tab\" }\nconst _hoisted_6 = [\"data-src\", \"onClick\"]\nconst _hoisted_7 = { class: \"tab-selector\" }\nconst _hoisted_8 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", { class: \"iconfont icon-biaoqing-xue\" }, null, -1))\nconst _hoisted_9 = [\n  _hoisted_8\n]\nconst _hoisted_10 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", { class: \"iconfont icon-jushoucang\" }, null, -1))\nconst _hoisted_11 = [\n  _hoisted_10\n]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_a_icon = _resolveComponent(\"a-icon\")!\n  const _component_a_upload = _resolveComponent(\"a-upload\")!\n  const _directive_clickoutside = _resolveDirective(\"clickoutside\")!\n\n  return _withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _withDirectives(_createElementVNode(\"div\", _hoisted_2, [\n      _withDirectives(_createElementVNode(\"div\", _hoisted_3, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.emojiNum, (item) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            class: \"emoji-item\",\n            onClick: ($event: any) => (_ctx.selectEmoji(0, item)),\n            key: item,\n            style: _normalizeStyle({ 'background-position': `0 ${-24 * item}px` })\n          }, null, 12, _hoisted_4))\n        }), 128))\n      ], 512), [\n        [_vShow, _ctx.currentTab === 0]\n      ]),\n      _withDirectives(_createElementVNode(\"div\", _hoisted_5, [\n        _createVNode(_component_a_upload, {\n          name: \"file\",\n          \"list-type\": \"picture-card\",\n          class: \"avatar-uploader emoticon-item\",\n          data: { emoticon: true },\n          \"show-upload-list\": false,\n          action: \"/api/files/upload_file\",\n          \"before-upload\": _ctx.beforeUpload,\n          onChange: _ctx.handleChange\n        }, {\n          default: _withCtx(() => [\n            _createElementVNode(\"div\", null, [\n              _createVNode(_component_a_icon, {\n                type: _ctx.uploadEmoLoading ? 'loading' : 'plus'\n              }, null, 8, [\"type\"])\n            ])\n          ]),\n          _: 1\n        }, 8, [\"before-upload\", \"onChange\"]),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.emoticonList, (item) => {\n          return (_openBlock(), _createElementBlock(\"img\", {\n            class: \"emoticon-item\",\n            \"data-src\": item.src,\n            alt: \"\",\n            key: item.id,\n            onDragstart: _cache[0] || (_cache[0] = _withModifiers(() => {}, [\"prevent\"])),\n            onClick: ($event: any) => (_ctx.selectEmoji(1, item.src))\n          }, null, 40, _hoisted_6))\n        }), 128))\n      ], 512), [\n        [_vShow, _ctx.currentTab === 1]\n      ]),\n      _createElementVNode(\"div\", _hoisted_7, [\n        _createElementVNode(\"div\", {\n          class: _normalizeClass([\"tab-item\", { 'current-tab-item': _ctx.currentTab == 0 }]),\n          onClick: _cache[1] || (_cache[1] = ($event: any) => (_ctx.currentTab = 0))\n        }, _hoisted_9, 2),\n        _createElementVNode(\"div\", {\n          class: _normalizeClass([\"tab-item\", { 'current-tab-item': _ctx.currentTab == 1 }]),\n          onClick: _cache[2] || (_cache[2] = ($event: any) => (_ctx.currentTab = 1))\n        }, _hoisted_11, 2)\n      ])\n    ], 512), [\n      [_vShow, _ctx.showDialog]\n    ]),\n    _createElementVNode(\"div\", {\n      class: \"btnContainer\",\n      onClick: _cache[3] || (_cache[3] = ($event: any) => (_ctx.showDialog = !_ctx.showDialog))\n    }, [\n      _renderSlot(_ctx.$slots, \"default\", {}, undefined, true)\n    ])\n  ])), [\n    [_directive_clickoutside, \r\n      () => {\r\n        _ctx.showDialog = false\r\n      }\r\n    ]\n  ])\n}","import { Emoticon } from '@/type'\r\nimport request from '@/utils/request'\r\n\r\n// 获取表情列表\r\nexport function api_getEmoticonList() {\r\n  return request.get('/emoticons/get_emoticon_list') as unknown as getEmoticonListType\r\n}\r\n\r\ntype getEmoticonListType = {\r\n  code: number,\r\n  list: Emoticon[]\r\n}\r\n\r\n// 添加自定义表情  不包含上传\r\nexport function api_addEmoticon(params: { src: string }) {\r\n  return request.get('/emoticons/add_emoticon', { params }) as unknown as addEmoticonType\r\n}\r\n\r\ntype addEmoticonType = {\r\n  code: number,\r\n  id: number,\r\n  src: string\r\n}","\r\nimport { api_getEmoticonList, api_addEmoticon } from '@/api/emoticon'\r\nimport { reactive, toRefs } from '@vue/reactivity'\r\nimport { defineComponent, onBeforeMount, onMounted } from '@vue/runtime-core'\r\nimport { message, UploadChangeParam } from 'ant-design-vue'\r\nimport useSubscribe from '@/hooks/subscribe'\r\n\r\nexport default defineComponent({\r\n  name: 'emoji-dialog',\r\n  setup(props, { emit }) {\r\n    const state: State = reactive({\r\n      // 是否展示表情框\r\n      showDialog: false,\r\n      emojiNum: 124,\r\n      // 当前表情框索引\r\n      currentTab: 0,\r\n      // 表情包列表\r\n      emoticonList: [],\r\n      //\r\n      uploadEmoLoading: false,\r\n    })\r\n\r\n    onBeforeMount(() => {\r\n      useSubscribe([{ msgName: 'addEmoticon', callback: addEmoticon }])\r\n    })\r\n\r\n    // 生命周期\r\n    onMounted(async () => {\r\n      // 获取自定义表情列表\r\n      let res = await api_getEmoticonList()\r\n      if (res) state.emoticonList = res.list\r\n    })\r\n\r\n    // methods\r\n    // 点击选择表情的回调\r\n    // type: 0:emoji   1:自定义表情\r\n    const selectEmoji = (type: number, item: number | string) => {\r\n      emit('selectEmoji', { type, item })\r\n      state.showDialog = false\r\n    }\r\n\r\n    const handleChange = (info: UploadChangeParam) => {\r\n      if (info.file.status === 'uploading') {\r\n        state.uploadEmoLoading = true\r\n        return\r\n      }\r\n      if (info.file.status === 'done') {\r\n        state.emoticonList.unshift({ id: info.file.response.id, src: info.file.response.src })\r\n        state.uploadEmoLoading = false\r\n      }\r\n    }\r\n\r\n    const beforeUpload = (file: File) => {\r\n      const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png'\r\n      if (!isJpgOrPng) {\r\n        message.error('You can only upload JPG file!')\r\n      }\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n      if (!isLt2M) {\r\n        message.error('Image must smaller than 2MB!')\r\n      }\r\n      return isJpgOrPng && isLt2M\r\n    }\r\n\r\n    const addEmoticon = async (name: string, src: string) => {\r\n      let res = await api_addEmoticon({ src })\r\n      if (res) {\r\n        message.success('表情收藏成功')\r\n        state.emoticonList.unshift({ src: res.src, id: res.id })\r\n      }\r\n    }\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      selectEmoji,\r\n      handleChange,\r\n      beforeUpload,\r\n    }\r\n  },\r\n})\r\n\r\ninterface State {\r\n  showDialog: boolean\r\n  emojiNum: number\r\n  currentTab: number\r\n  emoticonList: { id: number; src: string }[]\r\n  uploadEmoLoading: boolean\r\n}\r\n","import { render } from \"./EmojiDialog.vue?vue&type=template&id=dc32a2d6&scoped=true&ts=true\"\nimport script from \"./EmojiDialog.vue?vue&type=script&lang=ts\"\nexport * from \"./EmojiDialog.vue?vue&type=script&lang=ts\"\n\nimport \"./EmojiDialog.vue?vue&type=style&index=0&id=dc32a2d6&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-dc32a2d6\"]])\n\nexport default __exports__","import { vShow as _vShow, createElementVNode as _createElementVNode, withDirectives as _withDirectives, renderSlot as _renderSlot, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"upload-cmp\" }\nconst _hoisted_2 = { for: \"uploadFile\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _withDirectives(_createElementVNode(\"input\", {\n      type: \"file\",\n      id: \"uploadFile\",\n      onChange: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.uploadFile && _ctx.uploadFile(...args)))\n    }, null, 544), [\n      [_vShow, false]\n    ]),\n    _createElementVNode(\"label\", _hoisted_2, [\n      _renderSlot(_ctx.$slots, \"default\")\n    ])\n  ]))\n}","\r\nimport { defineComponent } from '@vue/runtime-core'\r\n\r\nexport default defineComponent({\r\n  name: 'upload-cmp',\r\n  setup(props, { emit }) {\r\n    const uploadFile = (e: Event) => {\r\n      let target = e.target as HTMLInputElement\r\n      if (target != null) {\r\n        let file = (target.files as FileList)[0]\r\n        // let file = (<FileList>(<HTMLInputElement>e.target).files)[0];\r\n        emit('uploadFile', file)\r\n        ;(e.target as HTMLInputElement).value = ''\r\n      }\r\n    }\r\n\r\n    return {\r\n      uploadFile,\r\n    }\r\n  },\r\n  methods: {},\r\n})\r\n","import { render } from \"./UploadCmp.vue?vue&type=template&id=e98590d6&ts=true\"\nimport script from \"./UploadCmp.vue?vue&type=script&lang=ts\"\nexport * from \"./UploadCmp.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","\r\nimport { guid } from '@/utils/utils'\r\nimport ChatInput from '@/components/ChatInput.vue'\r\nimport EmojiDialog from '@/components/EmojiDialog.vue'\r\nimport UploadCmp from '@/components/UploadCmp.vue'\r\n\r\nimport Pubsub from 'pubsub-js'\r\nimport { useStore } from 'vuex'\r\nimport { message } from 'ant-design-vue'\r\nimport { ComponentInternalInstance, getCurrentInstance } from 'vue'\r\n\r\nimport { FileInfo, InputChatItem } from '@/type'\r\n\r\nimport useWebRtc from '@/hooks/webrtc'\r\n\r\n// 最大呼叫时间\r\nconst MAXCALLTIME = 15\r\n\r\nexport default {\r\n  components: { ChatInput, EmojiDialog, UploadCmp },\r\n  name: 'input-box',\r\n  setup() {\r\n    const store = useStore()\r\n    const { proxy } = getCurrentInstance() as ComponentInternalInstance\r\n\r\n    // methods\r\n    // 发送消息的回调\r\n    // type 0:文字   1:图片    2:文件    3:自定义表情    4: 通知   5: 视频邀请\r\n    const sendMsg = (content: string | File, type = 0, fileInfo?: FileInfo) => {\r\n      let chatItem: InputChatItem = {\r\n        content,\r\n        receiverId: store.state.currentSession.receiverId,\r\n        uuid: guid(),\r\n        type,\r\n        sessionId: store.state.currentSession.sessionId,\r\n        fileInfo,\r\n      }\r\n      window.$socket.emit('chat', chatItem)\r\n\r\n      chatItem['senderId'] = store.state.userInfo.id\r\n      chatItem['status'] = 'loading'\r\n      chatItem['updatedAt'] = new Date().getTime()\r\n      if (type == 1 || type == 2) {\r\n        chatItem['content'] = window.URL.createObjectURL(content as File)\r\n        // 用于重发\r\n        chatItem['file'] = content as File\r\n      }\r\n      Pubsub.publish('sendMsg', chatItem)\r\n    }\r\n\r\n    // 选择表情的回调\r\n    const selectEmoji = ({ type, item }: { type: number; item: number | string }) => {\r\n      if (type === 0) {\r\n        proxy && (proxy.$refs.chatInput as typeof ChatInput).addEmoji(item)\r\n      } else if (type === 1) {\r\n        sendMsg(item.toString(), 3)\r\n      }\r\n    }\r\n\r\n    // 拖动drop文件的回调\r\n    const dropFile = (e: InputEvent) => {\r\n      // let file = e.dataTransfer?.files[0]\r\n      let file = e.dataTransfer && e.dataTransfer.files[0]\r\n      file && uploadFile(file)\r\n    }\r\n\r\n    // 上传文件\r\n    const uploadFile = (file: File) => {\r\n      if (file.size > 2 * 1024 * 1024) {\r\n        message.warn('上传的文件不能超过 2M 哦')\r\n        return\r\n      }\r\n      let type = /image\\/png|image\\/jpeg|image\\/gif/.test(file.type) ? 1 : 2\r\n\r\n      sendMsg(file, type, {\r\n        fileName: file.name,\r\n        size: file.size,\r\n      })\r\n    }\r\n\r\n    const videoHandler = () => {\r\n      // 发送视频邀请\r\n      sendMsg('[视频通话]', 5)\r\n      useWebRtc({ mode: 'sender', type: ['videoCall'] })\r\n      setTimeout(() => {\r\n        if (store.state.pc?.iceConnectionState === 'new') {\r\n          // new说明还没有进入连接状态   自动挂断\r\n          message.info('通话暂时无人接听哦!')\r\n          store.state.pc.hangup()\r\n        }\r\n      }, MAXCALLTIME * 1000)\r\n    }\r\n\r\n    return {\r\n      sendMsg,\r\n      dropFile,\r\n      uploadFile,\r\n      selectEmoji,\r\n      proxy,\r\n      videoHandler,\r\n      message,\r\n    }\r\n  },\r\n}\r\n","import { render } from \"./InputBox.vue?vue&type=template&id=2096d6d8&scoped=true&ts=true\"\nimport script from \"./InputBox.vue?vue&type=script&lang=ts\"\nexport * from \"./InputBox.vue?vue&type=script&lang=ts\"\n\nimport \"./InputBox.vue?vue&type=style&index=0&id=2096d6d8&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2096d6d8\"]])\n\nexport default __exports__","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, withCtx as _withCtx, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-ee9dd83a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"noti-dialog\" }\nconst _hoisted_2 = { class: \"\" }\nconst _hoisted_3 = {\n  key: 0,\n  class: \"noti-container\"\n}\nconst _hoisted_4 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"noti-title\" }, \"登录操作通知\", -1))\nconst _hoisted_5 = { class: \"noti-content\" }\nconst _hoisted_6 = { class: \"noti-detail\" }\nconst _hoisted_7 = { class: \"noti-detail-item\" }\nconst _hoisted_8 = { class: \"noti-detail-item\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_loading = _resolveComponent(\"loading\")!\n  const _component_scroll_box = _resolveComponent(\"scroll-box\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(_component_scroll_box, {\n      class: \"scroll-box\",\n      listenHeight: \"\",\n      ref: \"scrollBox\",\n      bottomDisabled: true,\n      topDisabled: _ctx.topDisabled,\n      onTouchTop: _ctx.touchTop\n    }, {\n      default: _withCtx(() => [\n        (!_ctx.topDisabled && _ctx.notiList.length >= 30)\n          ? (_openBlock(), _createBlock(_component_loading, { key: 0 }))\n          : _createCommentVNode(\"\", true),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.notiList, (item) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            class: \"noti-item\",\n            key: item.createdAt\n          }, [\n            _createElementVNode(\"div\", _hoisted_2, [\n              (item.type === 0)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                    _hoisted_4,\n                    _createElementVNode(\"div\", _hoisted_5, _toDisplayString(`你的账号 \"${_ctx.store.state.userInfo.userName}\" 进行了登录操作`), 1),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                      _createElementVNode(\"div\", _hoisted_7, \"登录ID：\" + _toDisplayString(_ctx.store.state.userInfo.id), 1),\n                      _createElementVNode(\"div\", _hoisted_8, \"登录时间：\" + _toDisplayString(item.createdAt && _ctx.handleTime(item.createdAt)), 1)\n                    ])\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ])\n          ]))\n        }), 128))\n      ]),\n      _: 1\n    }, 8, [\"topDisabled\", \"onTouchTop\"])\n  ]))\n}","import request from '@/utils/request'\r\nimport { Notification } from '@/type'\r\n\r\n// 获取通知列表\r\nexport function api_getNotiList(params: { lastTime?: (number | string) }) {\r\n  return request.get('/notis/get_noti_list', { params }) as unknown as getNotiListType\r\n}\r\n\r\ntype getNotiListType = {\r\n  code: number,\r\n  list: Notification[]\r\n}","\r\nimport { api_getNotiList } from '@/api/notification'\r\nimport ScrollBox from '@/components/ScrollBox.vue'\r\nimport Loading from '@/components/Loading.vue'\r\nimport moment from 'moment'\r\nimport { reactive, toRefs } from '@vue/reactivity'\r\nimport { onMounted, nextTick, getCurrentInstance, computed, ComponentInternalInstance, onBeforeMount, defineComponent } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { Notification, NotiMsg } from '@/type'\r\nimport useSubscribe from '@/hooks/subscribe'\r\n\r\nexport default defineComponent({\r\n  components: { ScrollBox, Loading },\r\n  name: 'noti-dialog',\r\n  setup() {\r\n    const { proxy } = getCurrentInstance() as ComponentInternalInstance\r\n    const store = useStore()\r\n    const state: State = reactive({\r\n      notiList: [],\r\n      // 禁止触顶\r\n      topDisabled: false,\r\n    })\r\n    const compute = {\r\n      handleTime: computed(() => (time: string) => moment(parseInt(time)).format('YYYY年MM月DD日 HH:mm')),\r\n    }\r\n\r\n    // 生命周期\r\n    onBeforeMount(() => {\r\n      useSubscribe([{ msgName: 'notice', callback: addNotification }])\r\n    })\r\n\r\n    onMounted(() => {\r\n      // 第一次创建时直接请求通知数据\r\n      getNotiList()\r\n    })\r\n\r\n    // methods\r\n    const getNotiList = async (lastTime?: number | string) => {\r\n      let res = await api_getNotiList({ lastTime })\r\n\r\n      if (res) {\r\n        let arr = res.list.reverse()\r\n        if (!lastTime) {\r\n          state.notiList.unshift(...arr)\r\n\r\n          // 没传时间，则是第一次获取聊天记录，滚动到底部\r\n          scrollToFunc('instant')\r\n        } else {\r\n          proxy &&\r\n            (proxy.$refs.scrollBox as typeof ScrollBox).keepHeight(() => {\r\n              state.notiList.unshift(...arr)\r\n            })\r\n        }\r\n\r\n        // 聊天记录一次请求30条，小于30条说明没有更多聊天数据了\r\n        state.topDisabled = arr.length !== 30\r\n      }\r\n    }\r\n\r\n    // 触顶的回调\r\n    const touchTop = () => {\r\n      state.topDisabled = true\r\n      getNotiList((state.notiList[0] as Notification).createdAt)\r\n    }\r\n\r\n    // 添加通知\r\n    const addNotification = (name: string, noti: NotiMsg) => {\r\n      let type = null\r\n      switch (noti?.msgType) {\r\n        case 'login':\r\n          type = 0\r\n          break\r\n      }\r\n      state.notiList.push({\r\n        type,\r\n        createdAt: noti.time.toString(),\r\n      })\r\n\r\n      // 判断当前是否离底，再进行滚动\r\n      if ((proxy?.$refs.scrollBox as typeof ScrollBox).getIsBottom(100)) {\r\n        scrollToFunc()\r\n      }\r\n    }\r\n\r\n    // 聊天框滚动到底部\r\n    const scrollToFunc = (behavior?: string) => {\r\n      nextTick(() => {\r\n        if (!proxy?.$refs.scrollBox) return\r\n        ;(proxy.$refs.scrollBox as typeof ScrollBox).scrollToFunc(behavior)\r\n      })\r\n    }\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      ...compute,\r\n      touchTop,\r\n      store,\r\n    }\r\n  },\r\n})\r\n\r\ninterface State {\r\n  notiList: Notification[]\r\n  topDisabled: boolean\r\n}\r\n","import { render } from \"./NotiDialog.vue?vue&type=template&id=ee9dd83a&scoped=true&ts=true\"\nimport script from \"./NotiDialog.vue?vue&type=script&lang=ts\"\nexport * from \"./NotiDialog.vue?vue&type=script&lang=ts\"\n\nimport \"./NotiDialog.vue?vue&type=style&index=0&id=ee9dd83a&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ee9dd83a\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-bdd6640a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = {\n  key: 0,\n  class: \"video-area\"\n}\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"video\", {\n  id: \"local-video\",\n  autoplay: \"\",\n  muted: \"\"\n}, null, -1))\nconst _hoisted_3 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"video\", {\n  id: \"remote-video\",\n  autoplay: \"\"\n}, null, -1))\nconst _hoisted_4 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", { class: \"iconfont icon-guaduan\" }, null, -1))\nconst _hoisted_5 = [\n  _hoisted_4\n]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_ctx.store.state.chatStatus.videoCall)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _hoisted_2,\n        _hoisted_3,\n        _createElementVNode(\"div\", {\n          class: \"hangup-btn\",\n          onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.store.state.pc.hangup()))\n        }, _hoisted_5)\n      ]))\n    : _createCommentVNode(\"\", true)\n}","\r\nimport { defineComponent } from '@vue/runtime-core'\r\nimport { useStore } from 'vuex'\r\n\r\nexport default defineComponent({\r\n  setup() {\r\n    const store = useStore()\r\n\r\n    return {\r\n      store,\r\n    }\r\n  },\r\n})\r\n","import { render } from \"./VideoWindow.vue?vue&type=template&id=bdd6640a&scoped=true&ts=true\"\nimport script from \"./VideoWindow.vue?vue&type=script&lang=ts\"\nexport * from \"./VideoWindow.vue?vue&type=script&lang=ts\"\n\nimport \"./VideoWindow.vue?vue&type=style&index=0&id=bdd6640a&lang=less&scoped=true\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-bdd6640a\"]])\n\nexport default __exports__","\r\nimport { defineComponent } from '@vue/runtime-core'\r\nimport { useStore } from 'vuex'\r\nimport ChatDialog from './children/chatDialog/ChatDialog.vue'\r\nimport ChatTopBar from './children/ChatTopBar.vue'\r\nimport InputBox from './children/InputBox.vue'\r\nimport NotiDialog from './children/NotiDialog.vue'\r\nimport VideoWindow from './children/VideoWindow.vue'\r\nexport default defineComponent({\r\n  components: { InputBox, ChatDialog, ChatTopBar, NotiDialog, VideoWindow },\r\n  name: 'chat-window',\r\n  setup() {\r\n    const store = useStore()\r\n\r\n    return {\r\n      store,\r\n    }\r\n  },\r\n})\r\n","import { render } from \"./ChatWindow.vue?vue&type=template&id=5377033d&scoped=true&ts=true\"\nimport script from \"./ChatWindow.vue?vue&type=script&lang=ts\"\nexport * from \"./ChatWindow.vue?vue&type=script&lang=ts\"\n\nimport \"./ChatWindow.vue?vue&type=style&index=0&id=5377033d&lang=less&scoped=true\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5377033d\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vShow as _vShow, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, withDirectives as _withDirectives, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-06df4bea\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"session-list\" }\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"session-top\" }, [\n  /*#__PURE__*/_createElementVNode(\"div\", { class: \"session-search\" }, [\n    /*#__PURE__*/_createElementVNode(\"i\", { class: \"iconfont icon-sousuoxiao\" }),\n    /*#__PURE__*/_createElementVNode(\"input\", {\n      type: \"text\",\n      placeholder: \"搜索\"\n    })\n  ])\n], -1))\nconst _hoisted_3 = [\"onClick\"]\nconst _hoisted_4 = { class: \"cover\" }\nconst _hoisted_5 = [\"src\"]\nconst _hoisted_6 = [\"textContent\"]\nconst _hoisted_7 = { class: \"session-info\" }\nconst _hoisted_8 = { class: \"session-name\" }\nconst _hoisted_9 = { class: \"name\" }\nconst _hoisted_10 = { class: \"update-at\" }\nconst _hoisted_11 = [\"innerHTML\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_loading = _resolveComponent(\"loading\")!\n  const _component_scroll_box = _resolveComponent(\"scroll-box\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _hoisted_2,\n    _createVNode(_component_scroll_box, {\n      listenHeight: \"\",\n      topDisabled: \"\",\n      bottomDisabled: _ctx.disabledLoad,\n      onTouchBottom: _ctx.touchBottom,\n      class: \"session-list-container\"\n    }, {\n      default: _withCtx(() => [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.store.state.sessionListData.list, (item) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            class: _normalizeClass([\"session-item\", { 'current-session': _ctx.store.state.currentSession && _ctx.store.state.currentSession.sessionId == item.sessionId }]),\n            key: item.sessionId,\n            onClick: ($event: any) => (_ctx.changeSession(item))\n          }, [\n            _createElementVNode(\"div\", _hoisted_4, [\n              _createElementVNode(\"img\", {\n                src: item.cover,\n                alt: \"\"\n              }, null, 8, _hoisted_5),\n              _withDirectives(_createElementVNode(\"div\", {\n                class: \"unread-num\",\n                style: _normalizeStyle(`font-weight:${item.read > 99 ? 'bold' : 'normal'}`),\n                textContent: _toDisplayString(item.read <= 99 ? item.read : '···')\n              }, null, 12, _hoisted_6), [\n                [_vShow, item.read]\n              ])\n            ]),\n            _createElementVNode(\"div\", _hoisted_7, [\n              _createElementVNode(\"div\", _hoisted_8, [\n                _createElementVNode(\"span\", _hoisted_9, _toDisplayString(item.sessionName), 1),\n                _createElementVNode(\"span\", _hoisted_10, _toDisplayString(_ctx.timeHandler(item.updatedAt)), 1)\n              ]),\n              _createElementVNode(\"div\", {\n                class: \"last-chat\",\n                innerHTML: _ctx.transToTag(item.lastChat, 16)\n              }, null, 8, _hoisted_11)\n            ])\n          ], 10, _hoisted_3))\n        }), 128)),\n        _withDirectives(_createVNode(_component_loading, {\n          class: \"loading\",\n          scale: 0.7\n        }, null, 8, [\"scale\"]), [\n          [_vShow, _ctx.store.state.sessionListData.isMore]\n        ])\n      ]),\n      _: 1\n    }, 8, [\"bottomDisabled\", \"onTouchBottom\"])\n  ]))\n}","\r\nimport { transToTag } from '@/utils/utils'\r\nimport ScrollBox from './ScrollBox.vue'\r\nimport Loading from './Loading.vue'\r\nimport Pubsub from 'pubsub-js'\r\n\r\nimport moment from 'moment'\r\nimport { reactive, toRefs, onMounted, computed, defineComponent } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { useRoute } from 'vue-router'\r\nimport { Session } from '@/type'\r\n\r\nexport default defineComponent({\r\n  components: { ScrollBox, Loading },\r\n  name: 'session-list',\r\n  setup() {\r\n    const store = useStore()\r\n    const route = useRoute()\r\n    const state = reactive({\r\n      // 是否禁止加载更多\r\n      disabledLoad: false,\r\n    })\r\n    const compute = {\r\n      timeHandler: computed(\r\n        () =>\r\n          function (time: string) {\r\n            if (parseInt(time) >= today) return moment(parseInt(time) * 1).format('HH:mm')\r\n            else return moment(parseInt(time) * 1).format('YY/M/DD')\r\n          }\r\n      ),\r\n    }\r\n\r\n    // 当天0点时间戳\r\n    let today = moment().startOf('day').valueOf()\r\n\r\n    if (route.params.friendId) {\r\n      // 将当前session改到friendId的会话窗口\r\n      let session = store.state.sessionListData.list.find((item: Session) => item.receiverId.toString() === route.params.friendId)\r\n      store.commit('setCurrentSession', session)\r\n    }\r\n\r\n    // 生命周期\r\n    onMounted(() => {\r\n      // 如果存在currentSession, 则重置当前session的read\r\n      if (store.state.currentSession) {\r\n        store.commit('setTotalUnread', store.state.totalUnread - store.state.currentSession.read)\r\n        store.state.currentSession.read = 0\r\n        window.$socket.emit('request', {\r\n          function: 'resetUnread',\r\n          params: {\r\n            sessionId: store.state.currentSession.sessionId,\r\n            userId: store.state.userInfo.id,\r\n          },\r\n        })\r\n      }\r\n    })\r\n\r\n    // methods\r\n    // 点击session-item的回调\r\n    const changeSession = (session: Session) => {\r\n      // this.totalUnread -= session.read;\r\n      store.commit('setTotalUnread', store.state.totalUnread - session.read)\r\n      // 清空未读数\r\n      session.read = 0\r\n      // api_resetUnread({ sessionId: session.sessionId })\r\n      window.$socket.emit('request', {\r\n        function: 'resetUnread',\r\n        params: {\r\n          sessionId: session.sessionId,\r\n          userId: store.state.userInfo.id,\r\n        },\r\n      })\r\n\r\n      let vuexSession = store.state.currentSession\r\n      if (vuexSession && vuexSession.sessionId === session.sessionId) return\r\n\r\n      store.commit('setCurrentSession', session)\r\n    }\r\n\r\n    const touchBottom = () => {\r\n      Pubsub.publish('loadSessionList')\r\n    }\r\n\r\n    return {\r\n      store,\r\n      ...toRefs(state),\r\n      ...compute,\r\n      touchBottom,\r\n      changeSession,\r\n      transToTag,\r\n    }\r\n  },\r\n})\r\n","import { render } from \"./SessionList.vue?vue&type=template&id=06df4bea&scoped=true&ts=true\"\nimport script from \"./SessionList.vue?vue&type=script&lang=ts\"\nexport * from \"./SessionList.vue?vue&type=script&lang=ts\"\n\nimport \"./SessionList.vue?vue&type=style&index=0&id=06df4bea&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-06df4bea\"]])\n\nexport default __exports__","\r\nimport ChatWindow from '@/components/chatWindow/ChatWindow.vue'\r\nimport SessionList from '@/components/SessionList.vue'\r\nimport { defineComponent } from '@vue/runtime-core'\r\n\r\nexport default defineComponent({\r\n  components: { ChatWindow, SessionList },\r\n  name: 'chat-page',\r\n})\r\n","import { render } from \"./Chat.vue?vue&type=template&id=560dd598&scoped=true&ts=true\"\nimport script from \"./Chat.vue?vue&type=script&lang=ts\"\nexport * from \"./Chat.vue?vue&type=script&lang=ts\"\n\nimport \"./Chat.vue?vue&type=style&index=0&id=560dd598&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\ubantu lts\\\\wwwroot\\\\socket_chat_vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-560dd598\"]])\n\nexport default __exports__"],"names":["subList","forEach","item","index","list","PubSub","subscribe","msgName","callback","onBeforeUnmount","unsubscribe","token","pcOption","iceServers","urls","mode","type","remoteVideo","localVideo","mediaStream","remoteStream","dc","onicecandidate","e","candidate","window","$socket","emit","data","receiverId","store","console","log","ontrack","nextTick","document","querySelector","srcObject","streams","oniceconnectionstatechange","pc","iceConnectionState","hangup","message","getLocalMediaStream","async","navigator","mediaDevices","getUserMedia","audio","video","getTracks","track","addTrack","senderId","id","stop","filter","length","close","status","createAnswer","answer","setLocalDescription","createOffer","offer","createDataChannelFunc","createDataChannel","onopen","send","onmessage","ondatachannel","channel","closedown","videoCallHander","then","catch","err","createOfferFunc","privateChatHander","RTCPeerConnection","indexOf","_hoisted_1","class","render","_ctx","_cache","$props","$setup","$data","$options","_component_session_list","_resolveComponent","_component_chat_window","_openBlock","_createElementBlock","_createVNode","key","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_component_chat_top_bar","_component_chat_dialog","_component_input_box","_component_noti_dialog","_component_video_window","state","currentSession","sessionId","_createElementVNode","src","require","alt","_component_loading","_component_scroll_box","onDrop","_withModifiers","$event","info","onDragover","listenHeight","ref","topDisabled","onTouchTop","getChatList","chatList","updatedAt","default","_withCtx","_createBlock","_createCommentVNode","_Fragment","_renderList","_resolveDynamicComponent","component","chat","content","_","api_getChatList","params","request","cancelToken","axios","c","cancelChatListFunc","_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_createTextVNode","_hoisted_11","_hoisted_12","_hoisted_13","_component_download_card","scale","title","onClick","args","resend","innerHTML","onContextmenu","rightClickPic","style","_normalizeStyle","imgStyle","onDragstart","checkImg","file","fileInfo","userInfo","avatar","download","fileName","_toDisplayString","sizeShow","downing","progress","defineComponent","name","props","Object","size","String","setup","reactive","compute","computed","toFixed","cancelFunc","isLocal","test","createTag","replace","process","VUE_APP_DOWNLOAD","responseType","onDownloadProgress","progressEvent","loaded","total","res","blob","URL","createObjectURL","a","createElement","href","click","revokeObjectURL","toRefs","__exports__","components","DownloadCard","Loading","useStore","transToTag","reg","arr","match","split","JSON","parse","others","timer","onMounted","createTimer","clearTimeout","chatItem","uuid","Pubsub","position","x","y","menuList","setTimeout","target","_hoisted_14","sort","userName","user","userItem","TalkerItem","ScrollBox","NotificationTag","Number","proxy","getCurrentInstance","scrollBox","timeTagFunc","onBeforeMount","createTimeTag","useSubscribe","sendMsg","receiveChat","sendMsgSuccess","sendMsgFail","$refs","lastTime","insertTimeTag","keepHeight","unshift","scrollToFunc","timeTag","push","msg","talkerId","getIsBottom","i","behavior","userId","today","moment","startOf","valueOf","thisWeek","week","item1","item2","updatedAt_item1","parseInt","updatedAt_item2","time","format","locale","toString","watch","current","sessionName","color","_component_emoji_dialog","_component_upload_cmp","_component_a_tooltip","_component_chat_input","tabindex","dropFile","onSelectEmoji","selectEmoji","onUploadFile","uploadFile","placement","videoHandler","onSendMsg","chatInput","contenteditable","onMousedown","getLastLocation","onKeydown","keydownFunc","onKeyup","keyupFunc","onPaste","pasteFunc","onInput","inputFunc","selection","lastLocation","$el","getSelection","addEmoji","emoji","draggable","insertNode","trim","getAltValue","clipboardData","files","getData","execCommand","node","createTextNode","appendChild","kc","keyCode","ctrlKey","preventDefault","scrollTo","top","scrollTop","range","selectAllChildren","collapseToEnd","focus","getRangeAt","collapse","removeAllRanges","addRange","deleteContents","_component_a_icon","_component_a_upload","_directive_clickoutside","_resolveDirective","_withDirectives","emojiNum","_vShow","currentTab","emoticon","action","beforeUpload","onChange","handleChange","uploadEmoLoading","emoticonList","_normalizeClass","showDialog","_renderSlot","$slots","undefined","api_getEmoticonList","api_addEmoticon","addEmoticon","response","isJpgOrPng","isLt2M","for","value","methods","MAXCALLTIME","ChatInput","EmojiDialog","UploadCmp","guid","Date","getTime","dataTransfer","useWebRtc","bottomDisabled","touchTop","notiList","createdAt","handleTime","api_getNotiList","addNotification","getNotiList","reverse","noti","msgType","autoplay","muted","chatStatus","videoCall","InputBox","ChatDialog","ChatTopBar","NotiDialog","VideoWindow","placeholder","disabledLoad","onTouchBottom","touchBottom","sessionListData","changeSession","cover","read","textContent","timeHandler","lastChat","isMore","route","useRoute","friendId","session","find","commit","totalUnread","function","vuexSession","ChatWindow","SessionList"],"sourceRoot":""}