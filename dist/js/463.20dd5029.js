"use strict";(self["webpackChunksocket_chat_vue3"]=self["webpackChunksocket_chat_vue3"]||[]).push([[463],{5269:function(n,e,r){r.d(e,{dj:function(){return s},fe:function(){return i},r:function(){return l},u2:function(){return a},xe:function(){return t}});var o=r(3512);function i(n){return o.Z.post("/users/login",n)}function s(n){return o.Z.post("/users/signin",n)}function a(){return o.Z.get("/users/getlogin")}function t(){return o.Z.get("/users/logout")}function l(n){return o.Z.get("/users/get_user_info",{params:n})}},5463:function(n,e,r){r.r(e),r.d(e,{default:function(){return Z}});var o=r(3396),i=r(7139),s=r(9242);const a={class:"login"},t={class:"login-card"},l=["src"],u={class:"register-card"},d={class:"reg-user-name"},g=["src"],c={key:1};function f(n,e,f,p,m,w){const v=(0,o.up)("a-icon"),_=(0,o.up)("a-upload");return(0,o.wg)(),(0,o.iD)("div",a,[(0,o._)("div",{class:(0,i.C_)(["card",{register:!n.isLogin}])},[(0,o._)("div",t,[(0,o._)("i",{class:"iconfont icon-qiehuan",onClick:e[0]||(e[0]=e=>n.isLogin=!n.isLogin)}),(0,o._)("img",{class:"avatar",src:r(4657),alt:""},null,8,l),(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=e=>n.loginInfo.userName=e),placeholder:"请输入用户名"},null,512),[[s.nr,n.loginInfo.userName]])]),(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=e=>n.loginInfo.password=e),placeholder:"请输入密码"},null,512),[[s.nr,n.loginInfo.password]])]),(0,o._)("div",{class:"btn",onClick:e[3]||(e[3]=(...e)=>n.login&&n.login(...e))},"登录")]),(0,o._)("div",u,[(0,o._)("i",{class:"iconfont icon-qiehuan",onClick:e[4]||(e[4]=e=>n.isLogin=!n.isLogin)}),(0,o._)("div",d,[(0,o.Wm)(_,{name:"file","list-type":"picture-card",class:"avatar-uploader upload-avatar","show-upload-list":!1,action:"/api/files/upload_file","before-upload":n.beforeUpload,onChange:n.handleChange},{default:(0,o.w5)((()=>[n.registerInfo.avatar?((0,o.wg)(),(0,o.iD)("img",{key:0,src:n.registerInfo.avatar,alt:"avatar"},null,8,g)):((0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(v,{type:n.imgLoading?"loading":"plus"},null,8,["type"])]))])),_:1},8,["before-upload","onChange"]),(0,o.wy)((0,o._)("input",{type:"text",placeholder:"取一个名字","onUpdate:modelValue":e[5]||(e[5]=e=>n.registerInfo.userName=e)},null,512),[[s.nr,n.registerInfo.userName]])]),(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{type:"password",placeholder:"输入你的密码","onUpdate:modelValue":e[6]||(e[6]=e=>n.registerInfo.password=e)},null,512),[[s.nr,n.registerInfo.password]])]),(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{type:"password",placeholder:"确认你的密码","onUpdate:modelValue":e[7]||(e[7]=e=>n.registerInfo.confirmPassword=e)},null,512),[[s.nr,n.registerInfo.confirmPassword]])]),(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{type:"text",placeholder:"输入你的邮箱","onUpdate:modelValue":e[8]||(e[8]=e=>n.registerInfo.email=e)},null,512),[[s.nr,n.registerInfo.email]])]),(0,o._)("div",{class:"btn",onClick:e[9]||(e[9]=(...e)=>n.signin&&n.signin(...e))},"注册")])],2)])}var p=r(5269),m=r(65),w=r(678),v=r(4870),_=r(7458),I=(0,o.aZ)({name:"ChatLogin",setup(){const n=(0,m.oR)(),e=(0,w.tv)(),r=(0,v.qj)({loginInfo:{userName:"",password:""},registerInfo:{avatar:"",userName:"",password:"",confirmPassword:"",email:""},isLogin:!0,imgLoading:!1});(0,o.bv)((()=>{n.state.userInfo&&e.go(0),window.$socket&&window.$socket.disconnect()}));const i=async()=>{for(var o in r.loginInfo)if(!r.loginInfo[o].trim())return void _.ZP.warning(`${o}不能为空哦`);let i=await(0,p.fe)(r.loginInfo);i&&(n.commit("setUserInfo",i.userInfo),e.push("/index"))},s=async()=>{for(var n in r.registerInfo)if(!r.registerInfo[n].trim())return void _.ZP.warning(`${n}不能为空哦`);if(r.registerInfo.password!==r.registerInfo.confirmPassword)return void _.ZP.warning("两次密码不一致");let e=/^[A-Za-z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;if(!e.test(r.registerInfo.email))return void _.ZP.warning("邮箱格式错误");let o=await(0,p.dj)(r.registerInfo);o&&(_.ZP.success("注册成功"),r.isLogin=!0,r.loginInfo={userName:r.registerInfo.userName,password:""})},a=n=>{"uploading"!==n.file.status?"done"===n.file.status&&(r.registerInfo.avatar=n.file.response.src,r.imgLoading=!1):r.isLogin=!0},t=n=>{const e="image/jpeg"===n.type||"image/png"===n.type;e||_.ZP.error("只能上传 JPG/PNG 格式的文件哦");const r=n.size/1024/1024<2;return r||_.ZP.error("图片大小不能超过2M"),e&&r};return{...(0,v.BK)(r),login:i,signin:s,handleChange:a,beforeUpload:t}}}),h=r(89);const y=(0,h.Z)(I,[["render",f],["__scopeId","data-v-6828b3fe"]]);var Z=y},4657:function(n,e,r){n.exports=r.p+"img/avatar.fcd1dd8c.jpg"}}]);
//# sourceMappingURL=463.20dd5029.js.map