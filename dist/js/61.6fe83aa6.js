"use strict";(self["webpackChunksocket_chat_vue3"]=self["webpackChunksocket_chat_vue3"]||[]).push([[61],{5269:function(e,n,r){r.d(n,{dj:function(){return i},fe:function(){return o},r:function(){return l},u2:function(){return a},xe:function(){return s}});var t=r(3512);function o(e){return t.Z.post("/users/login",e)}function i(e){return t.Z.post("/users/signin",e)}function a(){return t.Z.get("/users/getlogin")}function s(){return t.Z.get("/users/logout")}function l(e){return t.Z.get("/users/get_user_info",{params:e})}},7081:function(e,n,r){r.d(n,{Z:function(){return c}});var t=r(3396),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},i=o,a=r(9388);function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?Object(arguments[n]):{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){l(e,n,r[n])}))}return e}function l(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var u=function(e,n){var r=s({},e,n.attrs);return(0,t.Wm)(a.Z,s({},r,{icon:i}),null)};u.displayName="PlusOutlined",u.inheritAttrs=!1;var c=u},61:function(e,n,r){r.r(n),r.d(n,{default:function(){return P}});var t=r(3396),o=r(7139),i=r(9242);const a={class:"login"},s={class:"login-card"},l=["src"],u={class:"register-card"},c={class:"reg-user-name"},g=["src"],d={key:1};function f(e,n,f,p,m,v){const w=(0,t.up)("loading-outlined"),_=(0,t.up)("plus-outlined"),h=(0,t.up)("a-upload");return(0,t.wg)(),(0,t.iD)("div",a,[(0,t._)("div",{class:(0,o.C_)(["card",{register:!e.isLogin}])},[(0,t._)("div",s,[(0,t._)("i",{class:"iconfont icon-qiehuan",onClick:n[0]||(n[0]=n=>e.isLogin=!e.isLogin)}),(0,t._)("img",{class:"avatar",src:r(4657),alt:""},null,8,l),(0,t._)("div",null,[(0,t.wy)((0,t._)("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=n=>e.loginInfo.userName=n),placeholder:"请输入用户名"},null,512),[[i.nr,e.loginInfo.userName]])]),(0,t._)("div",null,[(0,t.wy)((0,t._)("input",{type:"password","onUpdate:modelValue":n[2]||(n[2]=n=>e.loginInfo.password=n),placeholder:"请输入密码",onKeydown:n[3]||(n[3]=(0,i.D2)(((...n)=>e.login&&e.login(...n)),["enter"]))},null,544),[[i.nr,e.loginInfo.password]])]),(0,t._)("div",{class:"btn",onClick:n[4]||(n[4]=(...n)=>e.login&&e.login(...n))},"登录")]),(0,t._)("div",u,[(0,t._)("i",{class:"iconfont icon-qiehuan",onClick:n[5]||(n[5]=n=>e.isLogin=!e.isLogin)}),(0,t._)("div",c,[(0,t.Wm)(h,{name:"file","list-type":"picture-card",class:"avatar-uploader upload-avatar","show-upload-list":!1,action:"/api/files/upload_file","before-upload":e.beforeUpload,onChange:e.handleChange},{default:(0,t.w5)((()=>[e.registerInfo.avatar?((0,t.wg)(),(0,t.iD)("img",{key:0,src:e.registerInfo.avatar,alt:"avatar"},null,8,g)):((0,t.wg)(),(0,t.iD)("div",d,[e.imgLoading?((0,t.wg)(),(0,t.j4)(w,{key:0})):((0,t.wg)(),(0,t.j4)(_,{key:1}))]))])),_:1},8,["before-upload","onChange"]),(0,t.wy)((0,t._)("input",{type:"text",placeholder:"取一个名字","onUpdate:modelValue":n[6]||(n[6]=n=>e.registerInfo.userName=n)},null,512),[[i.nr,e.registerInfo.userName]])]),(0,t._)("div",null,[(0,t.wy)((0,t._)("input",{type:"password",placeholder:"输入你的密码","onUpdate:modelValue":n[7]||(n[7]=n=>e.registerInfo.password=n)},null,512),[[i.nr,e.registerInfo.password]])]),(0,t._)("div",null,[(0,t.wy)((0,t._)("input",{type:"password",placeholder:"确认你的密码","onUpdate:modelValue":n[8]||(n[8]=n=>e.registerInfo.confirmPassword=n)},null,512),[[i.nr,e.registerInfo.confirmPassword]])]),(0,t._)("div",null,[(0,t.wy)((0,t._)("input",{type:"text",placeholder:"输入你的邮箱","onUpdate:modelValue":n[9]||(n[9]=n=>e.registerInfo.email=n),onKeydown:n[10]||(n[10]=(0,i.D2)(((...n)=>e.signin&&e.signin(...n)),["enter"]))},null,544),[[i.nr,e.registerInfo.email]])]),(0,t._)("div",{class:"btn",onClick:n[11]||(n[11]=(...n)=>e.signin&&e.signin(...n))},"注册")])],2)])}var p=r(5269),m=r(65),v=r(678),w=r(4870),_=r(7458),h=r(7081),y=r(2510),I=(0,t.aZ)({name:"ChatLogin",components:{PlusOutlined:h.Z,LoadingOutlined:y.Z},setup(){const e=(0,m.oR)(),n=(0,v.tv)(),r=(0,w.qj)({loginInfo:{userName:"",password:""},registerInfo:{avatar:"",userName:"",password:"",confirmPassword:"",email:""},isLogin:!0,imgLoading:!1});(0,t.bv)((()=>{e.state.userInfo&&n.go(0),e.state.socket?.disconnect()}));const o=async()=>{for(var t in r.loginInfo)if(!r.loginInfo[t].trim())return void _.ZP.warning(`${t}不能为空哦`);let o=await(0,p.fe)(r.loginInfo);o&&(e.commit("setUserInfo",o.userInfo),n.push("/index"))},i=async()=>{for(var e in r.registerInfo)if(!r.registerInfo[e].trim())return void _.ZP.warning(`${e}不能为空哦`);if(r.registerInfo.password!==r.registerInfo.confirmPassword)return void _.ZP.warning("两次密码不一致");let n=/^[A-Za-z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;if(!n.test(r.registerInfo.email))return void _.ZP.warning("邮箱格式错误");let t=await(0,p.dj)(r.registerInfo);t&&(_.ZP.success("注册成功"),r.isLogin=!0,r.loginInfo={userName:r.registerInfo.userName,password:""})},a=e=>{"uploading"!==e.file.status?"done"===e.file.status&&(r.registerInfo.avatar=e.file.response.src,r.imgLoading=!1):r.imgLoading=!0},s=e=>{const n="image/jpeg"===e.type||"image/png"===e.type;n||_.ZP.error("只能上传 JPG/PNG 格式的文件哦");const r=e.size/1024/1024<2;return r||_.ZP.error("图片大小不能超过2M"),n&&r};return{...(0,w.BK)(r),login:o,signin:i,handleChange:a,beforeUpload:s}}}),b=r(89);const Z=(0,b.Z)(I,[["render",f],["__scopeId","data-v-715a852a"]]);var P=Z},4657:function(e,n,r){e.exports=r.p+"img/avatar.fcd1dd8c.jpg"}}]);
//# sourceMappingURL=61.6fe83aa6.js.map